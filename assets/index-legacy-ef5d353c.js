!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=a.call(n)).done)&&(s.push(i.value),s.length!==t);u=!0);}catch(c){l=!0,r=c}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw r}}return s}}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},i.apply(this,arguments)}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function a(e){var t=c();return function(){var n,i=h(e);if(t){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return o(this,n)}}function o(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return s(t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return l(e,arguments,h(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),f(i,e)},u(e)}function l(e,t,n){return l=c()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&f(r,n.prototype),r},l.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function g(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,n||"default");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}function y(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */y=function(){return t};var t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(A){l=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var a=t&&t.prototype instanceof p?t:p,o=Object.create(a.prototype),s=new L(i||[]);return r(o,"_invoke",{value:P(e,n,s)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(A){return{type:"throw",arg:A}}}t.wrap=c;var h={};function p(){}function d(){}function g(){}var m={};l(m,o,(function(){return this}));var v=Object.getPrototypeOf,S=v&&v(v(T([])));S&&S!==n&&i.call(S,o)&&(m=S);var k=g.prototype=p.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(t,n){function a(r,o,s,u){var l=f(t[r],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==e(h)&&i.call(h,"__await")?n.resolve(h.__await).then((function(e){a("next",e,s,u)}),(function(e){a("throw",e,s,u)})):n.resolve(h).then((function(e){c.value=e,s(c)}),(function(e){return a("throw",e,s,u)}))}u(l.arg)}var o;r(this,"_invoke",{value:function(e,t){function i(){return new n((function(n,i){a(e,t,n,i)}))}return o=o?o.then(i,i):i()}})}function P(e,t,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return D()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=f(e,t,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}function x(e,t){var n=t.method,i=e.iterator[n];if(void 0===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var r=f(i,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,h;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:void 0,done:!0}}return d.prototype=g,r(k,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:d,configurable:!0}),d.displayName=l(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},b(C.prototype),l(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new C(c(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(k),l(k,u,"Generator"),l(k,o,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return o.type="throw",o.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function v(e,t,n,i,r,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(i,r)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function o(e){v(a,i,r,o,s,"next",e)}function s(e){v(a,i,r,o,s,"throw",e)}o(void 0)}))}}function k(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=b(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function b(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}System.register([],(function(l,c){"use strict";return{execute:function(){var l=document.createElement("style");l.textContent="body{height:100vh;width:100vw;display:flex;flex-direction:column;align-items:center;overflow-x:hidden}canvas#canvas{max-height:90vh;max-width:100%;object-fit:contain;border:10px #000 solid;margin:20px 0}\n",document.head.appendChild(l);var f={exports:{}};!function(e,t){!function(){var n={};function i(e){return f(">"+p("B",e.length),e)}function r(e){return f(">"+p("H",e.length),e)}function a(e){return f(">"+p("L",e.length),e)}function o(e,t,n){var o,s,u,l,c="",h="";if("Byte"==t)(o=e.length)<=4?h=i(e)+p("\0",4-o):(h=f(">L",[n]),c=i(e));else if("Short"==t)(o=e.length)<=2?h=r(e)+p("\0\0",2-o):(h=f(">L",[n]),c=r(e));else if("Long"==t)(o=e.length)<=1?h=a(e):(h=f(">L",[n]),c=a(e));else if("Ascii"==t)(o=(s=e+"\0").length)>4?(h=f(">L",[n]),c=s):h=s+p("\0",4-o);else if("Rational"==t){if("number"==typeof e[0])o=1,u=e[0],l=e[1],s=f(">L",[u])+f(">L",[l]);else{o=e.length,s="";for(var d=0;d<o;d++)u=e[d][0],l=e[d][1],s+=f(">L",[u])+f(">L",[l])}h=f(">L",[n]),c=s}else if("SRational"==t){if("number"==typeof e[0])o=1,u=e[0],l=e[1],s=f(">l",[u])+f(">l",[l]);else{o=e.length,s="";for(d=0;d<o;d++)u=e[d][0],l=e[d][1],s+=f(">l",[u])+f(">l",[l])}h=f(">L",[n]),c=s}else"Undefined"==t&&((o=e.length)>4?(h=f(">L",[n]),c=e):h=e+p("\0",4-o));return[f(">L",[o]),h,c]}function s(e,t,n){var i,r=Object.keys(e).length,a=f(">H",[r]);i=["0th","1st"].indexOf(t)>-1?2+12*r+4:2+12*r;var s="",u="";for(var l in e)if("string"==typeof l&&(l=parseInt(l)),!("0th"==t&&[34665,34853].indexOf(l)>-1||"Exif"==t&&40965==l||"1st"==t&&[513,514].indexOf(l)>-1)){var c=e[l],h=f(">H",[l]),p=m[t][l].type,d=f(">H",[g[p]]);"number"==typeof c&&(c=[c]);var y=o(c,p,8+i+n+u.length);s+=h+d+y[0]+y[1],u+=y[2]}return[a+s,u]}function u(e){var t;if("ÿØ"==e.slice(0,2))t=function(e){for(var t,n=0;n<e.length;n++)if("ÿá"==(t=e[n]).slice(0,2)&&"Exif\0\0"==t.slice(4,10))return t;return null}(d(e)),this.tiftag=t?t.slice(10):null;else if(["II","MM"].indexOf(e.slice(0,2))>-1)this.tiftag=e;else{if("Exif"!=e.slice(0,4))throw new Error("Given file is neither JPEG nor TIFF.");this.tiftag=e.slice(6)}}if(n.version="1.0.4",n.remove=function(e){var t=!1;if("ÿØ"==e.slice(0,2));else{if("data:image/jpeg;base64,"!=e.slice(0,23)&&"data:image/jpg;base64,"!=e.slice(0,22))throw new Error("Given data is not jpeg.");e=c(e.split(",")[1]),t=!0}var n=d(e).filter((function(e){return!("ÿá"==e.slice(0,2)&&"Exif\0\0"==e.slice(4,10))})).join("");return t&&(n="data:image/jpeg;base64,"+l(n)),n},n.insert=function(e,t){var n=!1;if("Exif\0\0"!=e.slice(0,6))throw new Error("Given data is not exif.");if("ÿØ"==t.slice(0,2));else{if("data:image/jpeg;base64,"!=t.slice(0,23)&&"data:image/jpg;base64,"!=t.slice(0,22))throw new Error("Given data is not jpeg.");t=c(t.split(",")[1]),n=!0}var i="ÿá"+f(">H",[e.length+2])+e,r=function(e,t){var n=!1,i=[];e.forEach((function(r,a){"ÿá"==r.slice(0,2)&&"Exif\0\0"==r.slice(4,10)&&(n?i.unshift(a):(e[a]=t,n=!0))})),i.forEach((function(t){e.splice(t,1)})),!n&&t&&(e=[e[0],t].concat(e.slice(1)));return e.join("")}(d(t),i);return n&&(r="data:image/jpeg;base64,"+l(r)),r},n.load=function(e){var t;if("string"!=typeof e)throw new Error("'load' gots invalid type argument.");if("ÿØ"==e.slice(0,2))t=e;else if("data:image/jpeg;base64,"==e.slice(0,23)||"data:image/jpg;base64,"==e.slice(0,22))t=c(e.split(",")[1]);else{if("Exif"!=e.slice(0,4))throw new Error("'load' gots invalid file data.");t=e.slice(6)}var n={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},i=new u(t);if(null===i.tiftag)return n;"II"==i.tiftag.slice(0,2)?i.endian_mark="<":i.endian_mark=">";var r=h(i.endian_mark+"L",i.tiftag.slice(4,8))[0];n["0th"]=i.get_ifd(r,"0th");var a=n["0th"].first_ifd_pointer;if(delete n["0th"].first_ifd_pointer,34665 in n["0th"]&&(r=n["0th"][34665],n.Exif=i.get_ifd(r,"Exif")),34853 in n["0th"]&&(r=n["0th"][34853],n.GPS=i.get_ifd(r,"GPS")),40965 in n.Exif&&(r=n.Exif[40965],n.Interop=i.get_ifd(r,"Interop")),"\0\0\0\0"!=a&&(r=h(i.endian_mark+"L",a)[0],n["1st"]=i.get_ifd(r,"1st"),513 in n["1st"]&&514 in n["1st"])){var o=n["1st"][513]+n["1st"][514],s=i.tiftag.slice(n["1st"][513],o);n.thumbnail=s}return n},n.dump=function(e){var t,i,r,a,o,u,l=(t=e,JSON.parse(JSON.stringify(t))),c=!1,h=!1,p=!1,m=!1;i="0th"in l?l["0th"]:{},"Exif"in l&&Object.keys(l.Exif).length||"Interop"in l&&Object.keys(l.Interop).length?(i[34665]=1,c=!0,r=l.Exif,"Interop"in l&&Object.keys(l.Interop).length?(r[40965]=1,p=!0,a=l.Interop):Object.keys(r).indexOf(n.ExifIFD.InteroperabilityTag.toString())>-1&&delete r[40965]):Object.keys(i).indexOf(n.ImageIFD.ExifTag.toString())>-1&&delete i[34665],"GPS"in l&&Object.keys(l.GPS).length?(i[n.ImageIFD.GPSTag]=1,h=!0,o=l.GPS):Object.keys(i).indexOf(n.ImageIFD.GPSTag.toString())>-1&&delete i[n.ImageIFD.GPSTag],"1st"in l&&"thumbnail"in l&&null!=l.thumbnail&&(m=!0,l["1st"][513]=1,l["1st"][514]=1,u=l["1st"]);var y,v,S,k=s(i,"0th",0),b=k[0].length+12*c+12*h+4+k[1].length,C="",P=0,x="",w=0,I="",L=0,T="";(c&&(P=(y=s(r,"Exif",b))[0].length+12*p+y[1].length),h&&(w=(x=s(o,"GPS",b+P).join("")).length),p)&&(L=(I=s(a,"Interop",b+P+w).join("")).length);if(m&&(v=s(u,"1st",b+P+w+L),(S=function(e){var t=d(e);for(;"ÿà"<=t[1].slice(0,2)&&t[1].slice(0,2)<="ÿï";)t=[t[0]].concat(t.slice(2));return t.join("")}(l.thumbnail)).length>64e3))throw new Error("Given thumbnail is too large. max 64kB");var D="",A="",R="",O="\0\0\0\0";if(c){var M=f(">L",[E=8+b]);D=f(">H",[34665])+f(">H",[g.Long])+f(">L",[1])+M}if(h){M=f(">L",[E=8+b+P]);A=f(">H",[34853])+f(">H",[g.Long])+f(">L",[1])+M}if(p){M=f(">L",[E=8+b+P+w]);R=f(">H",[40965])+f(">H",[g.Long])+f(">L",[1])+M}if(m){var E;O=f(">L",[E=8+b+P+w+L]);var F="\0\0\0\0"+f(">L",[E+v[0].length+24+4+v[1].length]),G="\0\0\0\0"+f(">L",[S.length]);T=v[0]+F+G+"\0\0\0\0"+v[1]+S}var U=k[0]+D+A+O+k[1];return c&&(C=y[0]+R+y[1]),"Exif\0\0MM\0*\0\0\0\b"+U+C+x+I+T},u.prototype={get_ifd:function(e,t){var n,i={},r=h(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],a=e+2;n=["0th","1st"].indexOf(t)>-1?"Image":t;for(var o=0;o<r;o++){e=a+12*o;var s=h(this.endian_mark+"H",this.tiftag.slice(e,e+2))[0],u=[h(this.endian_mark+"H",this.tiftag.slice(e+2,e+4))[0],h(this.endian_mark+"L",this.tiftag.slice(e+4,e+8))[0],this.tiftag.slice(e+8,e+12)];s in m[n]&&(i[s]=this.convert_value(u))}return"0th"==t&&(e=a+12*r,i.first_ifd_pointer=this.tiftag.slice(e,e+4)),i},convert_value:function(e){var t,n=null,i=e[0],r=e[1],a=e[2];if(1==i)r>4?(t=h(this.endian_mark+"L",a)[0],n=h(this.endian_mark+p("B",r),this.tiftag.slice(t,t+r))):n=h(this.endian_mark+p("B",r),a.slice(0,r));else if(2==i)r>4?(t=h(this.endian_mark+"L",a)[0],n=this.tiftag.slice(t,t+r-1)):n=a.slice(0,r-1);else if(3==i)r>2?(t=h(this.endian_mark+"L",a)[0],n=h(this.endian_mark+p("H",r),this.tiftag.slice(t,t+2*r))):n=h(this.endian_mark+p("H",r),a.slice(0,2*r));else if(4==i)r>1?(t=h(this.endian_mark+"L",a)[0],n=h(this.endian_mark+p("L",r),this.tiftag.slice(t,t+4*r))):n=h(this.endian_mark+p("L",r),a);else if(5==i)if(t=h(this.endian_mark+"L",a)[0],r>1){n=[];for(var o=0;o<r;o++)n.push([h(this.endian_mark+"L",this.tiftag.slice(t+8*o,t+4+8*o))[0],h(this.endian_mark+"L",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[h(this.endian_mark+"L",this.tiftag.slice(t,t+4))[0],h(this.endian_mark+"L",this.tiftag.slice(t+4,t+8))[0]];else if(7==i)r>4?(t=h(this.endian_mark+"L",a)[0],n=this.tiftag.slice(t,t+r)):n=a.slice(0,r);else if(9==i)r>1?(t=h(this.endian_mark+"L",a)[0],n=h(this.endian_mark+p("l",r),this.tiftag.slice(t,t+4*r))):n=h(this.endian_mark+p("l",r),a);else{if(10!=i)throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+i);if(t=h(this.endian_mark+"L",a)[0],r>1){n=[];for(o=0;o<r;o++)n.push([h(this.endian_mark+"l",this.tiftag.slice(t+8*o,t+4+8*o))[0],h(this.endian_mark+"l",this.tiftag.slice(t+4+8*o,t+8+8*o))[0]])}else n=[h(this.endian_mark+"l",this.tiftag.slice(t,t+4))[0],h(this.endian_mark+"l",this.tiftag.slice(t+4,t+8))[0]]}return n instanceof Array&&1==n.length?n[0]:n}},"undefined"!=typeof window&&"function"==typeof window.btoa)var l=window.btoa;if(void 0===l)l=function(e){for(var t,n,i,r,a,o,s,u="",l=0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l<e.length;)r=(t=e.charCodeAt(l++))>>2,a=(3&t)<<4|(n=e.charCodeAt(l++))>>4,o=(15&n)<<2|(i=e.charCodeAt(l++))>>6,s=63&i,isNaN(n)?o=s=64:isNaN(i)&&(s=64),u=u+c.charAt(r)+c.charAt(a)+c.charAt(o)+c.charAt(s);return u};if("undefined"!=typeof window&&"function"==typeof window.atob)var c=window.atob;if(void 0===c)c=function(e){var t,n,i,r,a,o,s="",u=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)t=l.indexOf(e.charAt(u++))<<2|(r=l.indexOf(e.charAt(u++)))>>4,n=(15&r)<<4|(a=l.indexOf(e.charAt(u++)))>>2,i=(3&a)<<6|(o=l.indexOf(e.charAt(u++))),s+=String.fromCharCode(t),64!=a&&(s+=String.fromCharCode(n)),64!=o&&(s+=String.fromCharCode(i));return s};function f(e,t){if(!(t instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(e.length-1!=t.length)throw new Error("'pack' error. "+(e.length-1)+" marks, "+t.length+" elements.");var n;if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("");n=!1}for(var i="",r=1,a=null,o=null,s=null;o=e[r];){if("b"==o.toLowerCase()){if(a=t[r-1],"b"==o&&a<0&&(a+=256),a>255||a<0)throw new Error("'pack' error.");s=String.fromCharCode(a)}else if("H"==o){if((a=t[r-1])>65535||a<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(a%65536/256))+String.fromCharCode(a%256),n&&(s=s.split("").reverse().join(""))}else{if("l"!=o.toLowerCase())throw new Error("'pack' error.");if(a=t[r-1],"l"==o&&a<0&&(a+=4294967296),a>4294967295||a<0)throw new Error("'pack' error.");s=String.fromCharCode(Math.floor(a/16777216))+String.fromCharCode(Math.floor(a%16777216/65536))+String.fromCharCode(Math.floor(a%65536/256))+String.fromCharCode(a%256),n&&(s=s.split("").reverse().join(""))}i+=s,r+=1}return i}function h(e,t){if("string"!=typeof t)throw new Error("'unpack' error. Got invalid type argument.");for(var n,i=0,r=1;r<e.length;r++)if("b"==e[r].toLowerCase())i+=1;else if("h"==e[r].toLowerCase())i+=2;else{if("l"!=e[r].toLowerCase())throw new Error("'unpack' error. Got invalid mark.");i+=4}if(i!=t.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+i+":"+t.length);if("<"==e[0])n=!0;else{if(">"!=e[0])throw new Error("'unpack' error.");n=!1}for(var a=[],o=0,s=1,u=null,l=null,c=null,f="";l=e[s];){if("b"==l.toLowerCase())c=1,u=(f=t.slice(o,o+c)).charCodeAt(0),"b"==l&&u>=128&&(u-=256);else if("H"==l)c=2,f=t.slice(o,o+c),n&&(f=f.split("").reverse().join("")),u=256*f.charCodeAt(0)+f.charCodeAt(1);else{if("l"!=l.toLowerCase())throw new Error("'unpack' error. "+l);c=4,f=t.slice(o,o+c),n&&(f=f.split("").reverse().join("")),u=16777216*f.charCodeAt(0)+65536*f.charCodeAt(1)+256*f.charCodeAt(2)+f.charCodeAt(3),"l"==l&&u>=2147483648&&(u-=4294967296)}a.push(u),o+=c,s+=1}return a}function p(e,t){for(var n="",i=0;i<t;i++)n+=e;return n}function d(e){if("ÿØ"!=e.slice(0,2))throw new Error("Given data isn't JPEG.");for(var t=2,n=["ÿØ"];;){if("ÿÚ"==e.slice(t,t+2)){n.push(e.slice(t));break}var i=t+h(">H",e.slice(t+2,t+4))[0]+2;if(n.push(e.slice(t,i)),(t=i)>=e.length)throw new Error("Wrong JPEG data.")}return n}var g={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},m={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};m["0th"]=m.Image,m["1st"]=m.Image,n.TAGS=m,n.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},n.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},n.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},n.InteropIFD={InteroperabilityIndex:1},n.GPSHelper={degToDmsRational:function(e){var t=Math.abs(e),n=t%1*60,i=n%1*60;return[[Math.floor(t),1],[Math.floor(n),1],[Math.round(100*i),100]]},dmsRationalToDeg:function(e,t){var n="S"===t||"W"===t?-1:1;return(e[0][0]/e[0][1]+e[1][0]/e[1][1]/60+e[2][0]/e[2][1]/3600)*n}},e.exports&&(t=e.exports=n),t.piexif=n}()}(f,f.exports);var d=f.exports,v="undefined"!=typeof self?self:global,b="undefined"!=typeof navigator,C=b&&"undefined"==typeof HTMLImageElement,P=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),x=v.Buffer,w=v.BigInt,I=!!x,L=function(e){return e};function T(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L;if(P)try{return"function"==typeof require?Promise.resolve(n(require(e))):(t=function(){return c.import(e)},t()).then(n)}catch(n){console.warn("Couldn't load ".concat(e))}}var D=v.fetch;if(!v.fetch){var A=T("http",(function(e){return e})),R=T("https",(function(e){return e}));!function(e){D=e}((function e(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).headers;return new Promise(function(){var i=S(y().mark((function i(r,a){var o,s,u,l,c,f,h,p;return y().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=new URL(t),s=o.port,u=o.hostname,l=o.pathname,c=o.protocol,f=o.search,h={method:"GET",hostname:u,path:encodeURI(l)+f,headers:n},""!==s&&(h.port=Number(s)),"https:"!==c){i.next=9;break}return i.next=6,R;case 6:i.t0=i.sent,i.next=12;break;case 9:return i.next=11,A;case 11:i.t0=i.sent;case 12:p=i.t0.request(h,(function(i){if(301===i.statusCode||302===i.statusCode){var o=new URL(i.headers.location,t).toString();return e(o,{headers:n}).then(r).catch(a)}r({status:i.statusCode,arrayBuffer:function(){return new Promise((function(e){var t=[];i.on("data",(function(e){return t.push(e)})),i.on("end",(function(){return e(Buffer.concat(t))}))}))}})})),p.on("error",a),p.end();case 14:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())}))}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M=function(e){return F(e)?void 0:e},E=function(e){return void 0!==e};function F(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(E).length)}function G(e){var t=new Error(e);throw delete t.stack,t}function U(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function B(e){var t=function(e){var t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}var N=function(e){return String.fromCharCode.apply(null,e)},j="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function V(e){return j?j.decode(e):I?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(N(e)))}var H=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(p(this,e),"boolean"==typeof r&&(this.le=r),Array.isArray(t)&&(t=new Uint8Array(t)),0===t)this.byteOffset=0,this.byteLength=0;else if(t instanceof ArrayBuffer){void 0===i&&(i=t.byteLength-n);var a=new DataView(t,n,i);this._swapDataView(a)}else if(t instanceof Uint8Array||t instanceof DataView||t instanceof e){void 0===i&&(i=t.byteLength-n),(n+=t.byteOffset)+i>t.byteOffset+t.byteLength&&G("Creating view outside of available memory in ArrayBuffer");var o=new DataView(t.buffer,n,i);this._swapDataView(o)}else if("number"==typeof t){var s=new DataView(new ArrayBuffer(t));this._swapDataView(s)}else G("Invalid input argument for BufferView: "+t)}return g(e,[{key:"_swapArrayBuffer",value:function(e){this._swapDataView(new DataView(e))}},{key:"_swapBuffer",value:function(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}},{key:"_swapDataView",value:function(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}},{key:"_lengthToEnd",value:function(e){return this.byteLength-e}},{key:"set",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return t instanceof DataView||t instanceof e?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||G("BufferView.set(): Invalid data argument."),this.toUint8().set(t,n),new i(this,n,t.byteLength)}},{key:"subarray",value:function(t,n){return new e(this,t,n=n||this._lengthToEnd(t))}},{key:"toUint8",value:function(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}},{key:"getUint8Array",value:function(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}},{key:"getString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength;return V(this.getUint8Array(e,t))}},{key:"getLatin1String",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return N(n)}},{key:"getUnicodeString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=[],i=0;i<t&&e+i<this.byteLength;i+=2)n.push(this.getUint16(e+i));return N(n)}},{key:"getInt8",value:function(e){return this.dataView.getInt8(e)}},{key:"getUint8",value:function(e){return this.dataView.getUint8(e)}},{key:"getInt16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt16(e,t)}},{key:"getInt32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt32(e,t)}},{key:"getUint16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint16(e,t)}},{key:"getUint32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint32(e,t)}},{key:"getFloat32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getFloat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getDouble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getUintBytes",value:function(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}},{key:"getUint",value:function(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}},{key:"toString",value:function(e){return this.dataView.toString(e,this.constructor.name)}},{key:"ensureChunk",value:function(){}}],[{key:"from",value:function(t,n){return t instanceof this&&t.le===n?t:new e(t,void 0,void 0,n)}}]),e}();function z(e,t){G("".concat(e," '").concat(t,"' was not loaded, try using full build of exifr."))}var _=function(e){r(n,e);var t=a(n);function n(e){var i;return p(this,n),(i=t.call(this)).kind=e,i}return g(n,[{key:"get",value:function(e,t){return this.has(e)||z(this.kind,e),t&&(e in t||function(e,t){G("Unknown ".concat(e," '").concat(t,"'."))}(this.kind,e),t[e].enabled||z(this.kind,e)),i(h(n.prototype),"get",this).call(this,e)}},{key:"keyList",value:function(){return Array.from(this.keys())}}]),n}(u(Map)),W=new _("file parser"),X=new _("segment parser"),K=new _("file reader");function J(e,t){return"string"==typeof e?Y(e,t):b&&!C&&e instanceof HTMLImageElement?Y(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new H(e):b&&e instanceof Blob?q(e,t,"blob",te):void G("Invalid input argument")}function Y(e,t){return(n=e).startsWith("data:")||n.length>1e4?Z(e,t,"base64"):P&&e.includes("://")?q(e,t,"url",ee):P?Z(e,t,"fs"):b?q(e,t,"url",ee):void G("Invalid input argument");var n}function q(e,t,n,i){return Q.apply(this,arguments)}function Q(){return Q=S(y().mark((function e(t,n,i,r){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",K.has(i)?Z(t,n,i):r?function(){var e=S(y().mark((function e(t,n){var i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:return i=e.sent,e.abrupt("return",new H(i));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,r):void G("Parser ".concat(i," is not loaded")));case 1:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function Z(e,t,n){return $.apply(this,arguments)}function $(){return $=S(y().mark((function e(t,n,i){var r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new(K.get(i))(t,n),e.next=3,r.read();case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}var ee=function(e){return D(e).then((function(e){return e.arrayBuffer()}))},te=function(e){return new Promise((function(t,n){var i=new FileReader;i.onloadend=function(){return t(i.result||new ArrayBuffer)},i.onerror=n,i.readAsArrayBuffer(e)}))},ne=function(e){r(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n,[{key:"tagKeys",get:function(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}},{key:"tagValues",get:function(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}]),n}(u(Map));function ie(e,t,i){var r,a=new ne,o=k(i);try{for(o.s();!(r=o.n()).done;){var s=n(r.value,2),u=s[0],l=s[1];a.set(u,l)}}catch(p){o.e(p)}finally{o.f()}if(Array.isArray(t)){var c,f=k(t);try{for(f.s();!(c=f.n()).done;){var h=c.value;e.set(h,a)}}catch(p){f.e(p)}finally{f.f()}}else e.set(t,a);return a}function re(e,t,n){var i,r,a=e.get(t),o=k(n);try{for(o.s();!(r=o.n()).done;)i=r.value,a.set(i[0],i[1])}catch(s){o.e(s)}finally{o.f()}}var ae=new Map,oe=new Map,se=new Map,ue=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],le=["jfif","xmp","icc","iptc","ihdr"],ce=["tiff"].concat(le),fe=["ifd0","ifd1","exif","gps","interop"],he=[].concat(t(ce),fe),pe=["makerNote","userComment"],de=["translateKeys","translateValues","reviveValues","multiSegment"],ge=[].concat(de,["sanitize","mergeOutput","silentErrors"]),me=function(){function e(){p(this,e)}return g(e,[{key:"translate",get:function(){return this.translateKeys||this.translateValues||this.reviveValues}}]),e}(),ye=function(t){r(i,t);var n=a(i);function i(t,r,a,u){var l;if(p(this,i),O(s(l=n.call(this)),"enabled",!1),O(s(l),"skip",new Set),O(s(l),"pick",new Set),O(s(l),"deps",new Set),O(s(l),"translateKeys",!1),O(s(l),"translateValues",!1),O(s(l),"reviveValues",!1),l.key=t,l.enabled=r,l.parse=l.enabled,l.applyInheritables(u),l.canBeFiltered=fe.includes(t),l.canBeFiltered&&(l.dict=ae.get(t)),void 0!==a)if(Array.isArray(a))l.parse=l.enabled=!0,l.canBeFiltered&&a.length>0&&l.translateTagSet(a,l.pick);else if("object"==e(a)){if(l.enabled=!0,l.parse=!1!==a.parse,l.canBeFiltered){var c=a.pick,f=a.skip;c&&c.length>0&&l.translateTagSet(c,l.pick),f&&f.length>0&&l.translateTagSet(f,l.skip)}l.applyInheritables(a)}else!0===a||!1===a?l.parse=l.enabled=a:G("Invalid options argument: ".concat(a));return o(l)}return g(i,[{key:"needed",get:function(){return this.enabled||this.deps.size>0}},{key:"applyInheritables",value:function(e){for(var t,n,i=0,r=de;i<r.length;i++)void 0!==(n=e[t=r[i]])&&(this[t]=n)}},{key:"translateTagSet",value:function(e,t){if(this.dict){var n,i,r,a=this.dict,o=a.tagKeys,s=a.tagValues,u=k(e);try{for(u.s();!(r=u.n()).done;)"string"==typeof(n=r.value)?(-1===(i=s.indexOf(n))&&(i=o.indexOf(Number(n))),-1!==i&&t.add(Number(o[i]))):t.add(n)}catch(h){u.e(h)}finally{u.f()}}else{var l,c=k(e);try{for(c.s();!(l=c.n()).done;){var f=l.value;t.add(f)}}catch(h){c.e(h)}finally{c.f()}}}},{key:"finalizeFilters",value:function(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Pe(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Pe(this.pick,this.deps)}}]),i}(me),ve={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},Se=new Map,ke=function(t){r(o,t);var i=a(o);function o(t){var n;return p(this,o),n=i.call(this),!0===t?n.setupFromTrue():void 0===t?n.setupFromUndefined():Array.isArray(t)?n.setupFromArray(t):"object"==e(t)?n.setupFromObject(t):G("Invalid options argument ".concat(t)),void 0===n.firstChunkSize&&(n.firstChunkSize=b?n.firstChunkSizeBrowser:n.firstChunkSizeNode),n.mergeOutput&&(n.ifd1.enabled=!1),n.filterNestedSegmentTags(),n.traverseTiffDependencyTree(),n.checkLoadedPlugins(),n}return g(o,[{key:"setupFromUndefined",value:function(){for(var e,t=0,n=ue;t<n.length;t++)this[e=n[t]]=ve[e];var i,r=k(ge);try{for(r.s();!(i=r.n()).done;)this[e=i.value]=ve[e]}catch(l){r.e(l)}finally{r.f()}for(var a=0,o=pe;a<o.length;a++)this[e=o[a]]=ve[e];var s,u=k(he);try{for(u.s();!(s=u.n()).done;)this[e=s.value]=new ye(e,ve[e],void 0,this)}catch(l){u.e(l)}finally{u.f()}}},{key:"setupFromTrue",value:function(){for(var e,t=0,n=ue;t<n.length;t++)this[e=n[t]]=ve[e];var i,r=k(ge);try{for(r.s();!(i=r.n()).done;)this[e=i.value]=ve[e]}catch(l){r.e(l)}finally{r.f()}for(var a=0,o=pe;a<o.length;a++)this[e=o[a]]=!0;var s,u=k(he);try{for(u.s();!(s=u.n()).done;)this[e=s.value]=new ye(e,!0,void 0,this)}catch(l){u.e(l)}finally{u.f()}}},{key:"setupFromArray",value:function(e){for(var t,n=0,i=ue;n<i.length;n++)this[t=i[n]]=ve[t];var r,a=k(ge);try{for(a.s();!(r=a.n()).done;)this[t=r.value]=ve[t]}catch(c){a.e(c)}finally{a.f()}for(var o=0,s=pe;o<s.length;o++)this[t=s[o]]=ve[t];var u,l=k(he);try{for(l.s();!(u=l.n()).done;)this[t=u.value]=new ye(t,!1,void 0,this)}catch(c){l.e(c)}finally{l.f()}this.setupGlobalFilters(e,void 0,fe)}},{key:"setupFromObject",value:function(t){for(var n,i=0,r=(fe.ifd0=fe.ifd0||fe.image,fe.ifd1=fe.ifd1||fe.thumbnail,Object.assign(this,t),ue);i<r.length;i++)this[n=r[i]]=Ce(t[n],ve[n]);var a,o=k(ge);try{for(o.s();!(a=o.n()).done;)this[n=a.value]=Ce(t[n],ve[n])}catch(p){o.e(p)}finally{o.f()}for(var s=0,u=pe;s<u.length;s++)this[n=u[s]]=Ce(t[n],ve[n]);var l,c=k(ce);try{for(c.s();!(l=c.n()).done;)this[n=l.value]=new ye(n,ve[n],t[n],this)}catch(p){c.e(p)}finally{c.f()}for(var f=0,h=fe;f<h.length;f++)this[n=h[f]]=new ye(n,ve[n],t[n],this.tiff);this.setupGlobalFilters(t.pick,t.skip,fe,he),!0===t.tiff?this.batchEnableWithBool(fe,!0):!1===t.tiff?this.batchEnableWithUserValue(fe,t):Array.isArray(t.tiff)?this.setupGlobalFilters(t.tiff,void 0,fe):"object"==e(t.tiff)&&this.setupGlobalFilters(t.tiff.pick,t.tiff.skip,fe)}},{key:"batchEnableWithBool",value:function(e,t){var n,i=k(e);try{for(i.s();!(n=i.n()).done;){this[n.value].enabled=t}}catch(r){i.e(r)}finally{i.f()}}},{key:"batchEnableWithUserValue",value:function(e,t){var n,i=k(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,a=t[r];this[r].enabled=!1!==a&&void 0!==a}}catch(o){i.e(o)}finally{i.f()}}},{key:"setupGlobalFilters",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;if(e&&e.length){var a,o=k(r);try{for(o.s();!(a=o.n()).done;){this[a.value].enabled=!1}}catch(y){o.e(y)}finally{o.f()}var s,u=k(be(e,i));try{for(u.s();!(s=u.n()).done;){var l=n(s.value,2),c=l[0],f=l[1];Pe(this[c].pick,f),this[c].enabled=!0}}catch(y){u.e(y)}finally{u.f()}}else if(t&&t.length){var h,p=k(be(t,i));try{for(p.s();!(h=p.n()).done;){var d=n(h.value,2),g=d[0],m=d[1];Pe(this[g].skip,m)}}catch(y){p.e(y)}finally{p.f()}}}},{key:"filterNestedSegmentTags",value:function(){var e=this.ifd0,t=this.exif,n=this.xmp,i=this.iptc,r=this.icc;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),n.enabled||e.skip.add(700),i.enabled||e.skip.add(33723),r.enabled||e.skip.add(34675)}},{key:"traverseTiffDependencyTree",value:function(){var e=this,t=this.ifd0,n=this.exif,i=this.gps;this.interop.needed&&(n.deps.add(40965),t.deps.add(40965)),n.needed&&t.deps.add(34665),i.needed&&t.deps.add(34853),this.tiff.enabled=fe.some((function(t){return!0===e[t].enabled}))||this.makerNote||this.userComment;for(var r=0,a=fe;r<a.length;r++){this[a[r]].finalizeFilters()}}},{key:"onlyTiff",get:function(){var e=this;return!le.map((function(t){return e[t].enabled})).some((function(e){return!0===e}))&&this.tiff.enabled}},{key:"checkLoadedPlugins",value:function(){var e,t=k(ce);try{for(t.s();!(e=t.n()).done;){var n=e.value;this[n].enabled&&!X.has(n)&&z("segment parser",n)}}catch(i){t.e(i)}finally{t.f()}}}],[{key:"useCached",value:function(e){var t=Se.get(e);return void 0!==t||(t=new this(e),Se.set(e,t)),t}}]),o}(me);function be(e,t){var n,i,r,a,o,s=[],u=k(t);try{for(u.s();!(o=u.n()).done;){r=o.value;var l,c=k((n=ae.get(r),i=[],n));try{for(c.s();!(l=c.n()).done;)a=l.value,(e.includes(a[0])||e.includes(a[1]))&&i.push(a[0])}catch(f){c.e(f)}finally{c.f()}i.length&&s.push([r,i])}}catch(f){u.e(f)}finally{u.f()}return s}function Ce(e,t){return void 0!==e?e:void 0!==t?t:void 0}function Pe(e,t){var n,i=k(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;e.add(r)}}catch(a){i.e(a)}finally{i.f()}}O(ke,"default",ve);var xe=function(){function e(t){var n=this;p(this,e),O(this,"parsers",{}),O(this,"output",{}),O(this,"errors",[]),O(this,"pushToErrors",(function(e){return n.errors.push(e)})),this.options=ke.useCached(t)}var i,r,a,o;return g(e,[{key:"read",value:(o=S(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J(t,this.options);case 2:this.file=e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"setup",value:function(){if(!this.fileParser){var e,t=this.file,i=t.getUint16(0),r=k(W);try{for(r.s();!(e=r.n()).done;){var a=n(e.value,2),o=a[0],s=a[1];if(s.canHandle(t,i))return this.fileParser=new s(this.options,this.file,this.parsers),t[o]=!0}}catch(u){r.e(u)}finally{r.f()}this.file.close&&this.file.close(),G("Unknown file format")}}},{key:"parse",value:(a=S(y().mark((function e(){var n,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.output,i=this.errors,this.setup(),!this.options.silentErrors){e.next=8;break}return e.next=5,this.executeParsers().catch(this.pushToErrors);case 5:i.push.apply(i,t(this.fileParser.errors)),e.next=10;break;case 8:return e.next=10,this.executeParsers();case 10:return this.file.close&&this.file.close(),this.options.silentErrors&&i.length>0&&(n.errors=i),e.abrupt("return",M(n));case 13:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"executeParsers",value:(r=S(y().mark((function e(){var t,n,i=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.output,e.next=3,this.fileParser.parse();case 3:return n=Object.values(this.parsers).map(function(){var e=S(y().mark((function e(n){var i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.parse();case 2:i=e.sent,n.assignToOutput(t,i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.options.silentErrors&&(n=n.map((function(e){return e.catch(i.pushToErrors)}))),e.next=7,Promise.all(n);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"extractThumbnail",value:(i=S(y().mark((function e(){var t,n,i,r,a,o,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setup(),t=this.options,n=this.file,i=X.get("tiff",t),!n.tiff){e.next=6;break}r={start:0,type:"tiff"},e.next=11;break;case 6:if(e.t0=n.jpeg,!e.t0){e.next=11;break}return e.next=10,this.fileParser.getOrFindSegment("tiff");case 10:r=e.sent;case 11:if(void 0!==r){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,this.fileParser.ensureSegmentChunk(r);case 15:return a=e.sent,o=this.parsers.tiff=new i(a,t,n),e.next=19,o.extractThumbnail();case 19:return s=e.sent,e.abrupt("return",(n.close&&n.close(),s));case 21:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})}]),e}();function we(e,t){return Ie.apply(this,arguments)}function Ie(){return Ie=S(y().mark((function e(t,n){var i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new xe(n),e.next=3,i.read(t);case 3:return e.abrupt("return",i.parse());case 4:case"end":return e.stop()}}),e)}))),Ie.apply(this,arguments)}var Le=function(){function e(t,n,i){var r=this;p(this,e),O(this,"errors",[]),O(this,"ensureSegmentChunk",function(){var e=S(y().mark((function e(t){var n,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.start,i=t.size||65536,!r.file.chunked){e.next=17;break}if(!r.file.available(n,i)){e.next=6;break}t.chunk=r.file.subarray(n,i),e.next=15;break;case 6:return e.prev=6,e.next=9,r.file.readChunk(n,i);case 9:t.chunk=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),G("Couldn't read segment: ".concat(JSON.stringify(t),". ").concat(e.t0.message));case 15:e.next=18;break;case 17:r.file.byteLength>n+i?t.chunk=r.file.subarray(n,i):void 0===t.size?t.chunk=r.file.subarray(n):G("Segment unreachable: "+JSON.stringify(t));case 18:return e.abrupt("return",t.chunk);case 19:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}()),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=n,this.parsers=i}var t;return g(e,[{key:"injectSegment",value:function(e,t){this.options[e].enabled&&this.createParser(e,t)}},{key:"createParser",value:function(e,t){var n=new(X.get(e))(t,this.options,this.file);return this.parsers[e]=n}},{key:"createParsers",value:function(e){var t,n=k(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.type,a=i.chunk,o=this.options[r];if(o&&o.enabled){var s=this.parsers[r];s&&s.append||s||this.createParser(r,a)}}}catch(u){n.e(u)}finally{n.f()}}},{key:"readSegments",value:(t=S(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(this.ensureSegmentChunk),e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}(),Te=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;p(this,e),O(this,"errors",[]),O(this,"raw",new Map),O(this,"handleError",(function(e){if(!n.options.silentErrors)throw e;n.errors.push(e.message)})),this.chunk=this.normalizeInput(t),this.file=r,this.type=this.constructor.type,this.globalOptions=this.options=i,this.localOptions=i[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}return g(e,[{key:"normalizeInput",value:function(e){return e instanceof H?e:new H(e)}},{key:"translate",value:function(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}},{key:"output",get:function(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}},{key:"translateBlock",value:function(e,t){var i,r=se.get(t),a=oe.get(t),o=ae.get(t),s=this.options[t],u=s.reviveValues&&!!r,l=s.translateValues&&!!a,c=s.translateKeys&&!!o,f={},h=k(e);try{for(h.s();!(i=h.n()).done;){var p=n(i.value,2),d=p[0],g=p[1];u&&r.has(d)?g=r.get(d)(g):l&&a.has(d)&&(g=this.translateValue(g,a.get(d))),c&&o.has(d)&&(d=o.get(d)||d),f[d]=g}}catch(m){h.e(m)}finally{h.f()}return f}},{key:"translateValue",value:function(e,t){return t[e]||t.DEFAULT||e}},{key:"assignToOutput",value:function(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}},{key:"assignObjectToOutput",value:function(e,t,n){if(this.globalOptions.mergeOutput)return Object.assign(e,n);e[t]?Object.assign(e[t],n):e[t]=n}}],[{key:"findPosition",value:function(e,t){var n=e.getUint16(t+2)+2,i="function"==typeof this.headerLength?this.headerLength(e,t,n):this.headerLength,r=t+i,a=n-i;return{offset:t,length:n,headerLength:i,start:r,size:a,end:r+a}}},{key:"parse",value:function(e){var t,n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this(e,new ke((t={},n=this.type,i=r,(n=m(n))in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t)),e).parse()}}]),e}();function De(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function Ae(e){return e>=224&&e<=239}function Re(e,t,i){var r,a=k(X);try{for(a.s();!(r=a.n()).done;){var o=n(r.value,2),s=o[0];if(o[1].canHandle(e,t,i))return s}}catch(u){a.e(u)}finally{a.f()}}O(Te,"headerLength",4),O(Te,"type",void 0),O(Te,"multiSegment",!1),O(Te,"canHandle",(function(){return!1}));var Oe=function(e){r(l,e);var t,i,o,u=a(l);function l(){var e;p(this,l);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return O(s(e=u.call.apply(u,[this].concat(n))),"appSegments",[]),O(s(e),"jpegSegments",[]),O(s(e),"unknownSegments",[]),e}return g(l,[{key:"parse",value:(o=S(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findAppSegments();case 2:return e.next=4,this.readSegments(this.appSegments);case 4:this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"setupSegmentFinderArgs",value:function(e){var t=this;!0===e?(this.findAll=!0,this.wanted=new Set(X.keyList())):(e=void 0===e?X.keyList().filter((function(e){return t.options[e].enabled})):e.filter((function(e){return t.options[e].enabled&&X.has(e)})),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}},{key:"findAppSegments",value:(i=S(y().mark((function e(){var t,n,i,r,a,o,s,u,l,c=this,f=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:0,n=f.length>1?f[1]:void 0,this.setupSegmentFinderArgs(n),i=this.file,r=this.findAll,a=this.wanted,o=this.remaining,e.t0=!r&&this.file.chunked,!e.t0){e.next=11;break}if(r=Array.from(a).some((function(e){var t=X.get(e),n=c.options[e];return t.multiSegment&&n.multiSegment})),e.t1=r,!e.t1){e.next=11;break}return e.next=11,this.file.readWhole();case 11:if(t=this.findAppSegmentsInRange(t,i.byteLength),this.options.onlyTiff||!i.chunked){e.next=30;break}s=!1;case 14:if(!(o.size>0)||s||!i.canReadNextChunk&&!this.unfinishedMultiSegment){e.next=30;break}if(u=i.nextChunkOffset,l=this.appSegments.some((function(e){return!c.file.available(e.offset||e.start,e.length||e.size)})),!(t>u)||l){e.next=22;break}return e.next=19,i.readNextChunk(t);case 19:e.t2=!e.sent,e.next=25;break;case 22:return e.next=24,i.readNextChunk(u);case 24:e.t2=!e.sent;case 25:if(s=e.t2,void 0!==(t=this.findAppSegmentsInRange(t,i.byteLength))){e.next=28;break}return e.abrupt("return");case 28:e.next=14;break;case 30:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"findAppSegmentsInRange",value:function(e,t){t-=2;for(var n,i,r,a,o,s,u=this.file,l=this.findAll,c=this.wanted,f=this.remaining,h=this.options;e<t;e++)if(255===u.getUint8(e))if(Ae(n=u.getUint8(e+1))){if(i=u.getUint16(e+2),(r=Re(u,e,i))&&c.has(r)&&(o=(a=X.get(r)).findPosition(u,e),s=h[r],o.type=r,this.appSegments.push(o),!l&&(a.multiSegment&&s.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||f.delete(r)):f.delete(r),0===f.size)))break;h.recordUnknownSegments&&((o=Te.findPosition(u,e)).marker=n,this.unknownSegments.push(o)),e+=i+1}else if(De(n)){if(i=u.getUint16(e+2),218===n&&!1!==h.stopAfterSos)return;h.recordJpegSegments&&this.jpegSegments.push({offset:e,length:i,marker:n}),e+=i+1}return e}},{key:"mergeMultiSegments",value:function(){var e=this;if(this.appSegments.some((function(e){return e.multiSegment}))){var t=function(e,t){for(var n,i,r,a=new Map,o=0;o<e.length;o++)i=(n=e[o]).type,a.has(i)?r=a.get(i):a.set(i,r=[]),r.push(n);return Array.from(a)}(this.appSegments);this.mergedAppSegments=t.map((function(t){var i=n(t,2),r=i[0],a=i[1],o=X.get(r,e.options);return o.handleMultiSegments?{type:r,chunk:o.handleMultiSegments(a)}:a[0]}))}}},{key:"getSegment",value:function(e){return this.appSegments.find((function(t){return t.type===e}))}},{key:"getOrFindSegment",value:(t=S(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getSegment(t),e.t0=void 0===n,!e.t0){e.next=6;break}return e.next=5,this.findAppSegments(0,[t]);case 5:n=this.getSegment(t);case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"canHandle",value:function(e,t){return 65496===t}}]),l}(Le);O(Oe,"type","jpeg"),W.set("jpeg",Oe);var Me=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4],Ee=function(e){r(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n,[{key:"parseHeader",value:function(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}},{key:"parseTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,i=this.options[t],r=i.pick,a=i.skip,o=(r=new Set(r)).size>0,s=0===a.size,u=this.chunk.getUint16(e);e+=2;for(var l=0;l<u;l++){var c=this.chunk.getUint16(e);if(o){if(r.has(c)&&(n.set(c,this.parseTag(e,c,t)),r.delete(c),0===r.size))break}else!s&&a.has(c)||n.set(c,this.parseTag(e,c,t));e+=12}return n}},{key:"parseTag",value:function(e,t,n){var i=this.chunk,r=i.getUint16(e+2),a=i.getUint32(e+4),o=Me[r];if(o*a<=4?e+=8:e=i.getUint32(e+8),(r<1||r>13)&&G("Invalid TIFF value type. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(r,", offset ").concat(e)),e>i.byteLength&&G("Invalid TIFF value offset. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(r,", offset ").concat(e," is outside of chunk size ").concat(i.byteLength)),1===r)return i.getUint8Array(e,a);if(2===r)return U(i.getString(e,a));if(7===r)return i.getUint8Array(e,a);if(1===a)return this.parseTagValue(r,e);for(var s=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(r))(a),u=o,l=0;l<a;l++)s[l]=this.parseTagValue(r,e),e+=u;return s}},{key:"parseTagValue",value:function(e,t){var n=this.chunk;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:case 13:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);default:G("Invalid tiff type ".concat(e))}}}]),n}(Te),Fe=function(e){r(d,e);var i,o,s,u,l,c,f,h=a(d);function d(){return p(this,d),h.apply(this,arguments)}return g(d,[{key:"parse",value:(f=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.parseHeader(),t=this.options,e.t0=t.ifd0.enabled,!e.t0){e.next=6;break}return e.next=6,this.parseIfd0Block();case 6:if(e.t1=t.exif.enabled,!e.t1){e.next=10;break}return e.next=10,this.safeParse("parseExifBlock");case 10:if(e.t2=t.gps.enabled,!e.t2){e.next=14;break}return e.next=14,this.safeParse("parseGpsBlock");case 14:if(e.t3=t.interop.enabled,!e.t3){e.next=18;break}return e.next=18,this.safeParse("parseInteropBlock");case 18:if(e.t4=t.ifd1.enabled,!e.t4){e.next=22;break}return e.next=22,this.safeParse("parseThumbnailBlock");case 22:return e.abrupt("return",this.createOutput());case 23:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"safeParse",value:function(e){var t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}},{key:"findIfd0Offset",value:function(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}},{key:"findIfd1Offset",value:function(){if(void 0===this.ifd1Offset){this.findIfd0Offset();var e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}},{key:"parseBlock",value:function(e,t){var n=new Map;return this[t]=n,this.parseTags(e,t,n),n}},{key:"parseIfd0Block",value:(c=S(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ifd0){e.next=2;break}return e.abrupt("return");case 2:if(t=this.file,this.findIfd0Offset(),this.ifd0Offset<8&&G("Malformed EXIF data"),!t.chunked&&this.ifd0Offset>t.byteLength&&G("IFD0 offset points to outside of file.\nthis.ifd0Offset: ".concat(this.ifd0Offset,", file.byteLength: ").concat(t.byteLength)),e.t0=t.tiff,!e.t0){e.next=10;break}return e.next=10,t.ensureChunk(this.ifd0Offset,B(this.options));case 10:return n=this.parseBlock(this.ifd0Offset,"ifd0"),e.abrupt("return",0!==n.size?(this.exifOffset=n.get(34665),this.interopOffset=n.get(40965),this.gpsOffset=n.get(34853),this.xmp=n.get(700),this.iptc=n.get(33723),this.icc=n.get(34675),this.options.sanitize&&(n.delete(34665),n.delete(40965),n.delete(34853),n.delete(700),n.delete(33723),n.delete(34675)),n):void 0);case 12:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"parseExifBlock",value:(l=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.exif){e.next=2;break}return e.abrupt("return");case 2:if(e.t0=this.ifd0,e.t0){e.next=6;break}return e.next=6,this.parseIfd0Block();case 6:if(void 0!==this.exifOffset){e.next=8;break}return e.abrupt("return");case 8:if(e.t1=this.file.tiff,!e.t1){e.next=12;break}return e.next=12,this.file.ensureChunk(this.exifOffset,B(this.options));case 12:return t=this.parseBlock(this.exifOffset,"exif"),e.abrupt("return",(this.interopOffset||(this.interopOffset=t.get(40965)),this.makerNote=t.get(37500),this.userComment=t.get(37510),this.options.sanitize&&(t.delete(40965),t.delete(37500),t.delete(37510)),this.unpack(t,41728),this.unpack(t,41729),t));case 14:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"unpack",value:function(e,t){var n=e.get(t);n&&1===n.length&&e.set(t,n[0])}},{key:"parseGpsBlock",value:(u=S(y().mark((function e(){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gps){e.next=2;break}return e.abrupt("return");case 2:if(e.t0=this.ifd0,e.t0){e.next=6;break}return e.next=6,this.parseIfd0Block();case 6:if(void 0!==this.gpsOffset){e.next=8;break}return e.abrupt("return");case 8:return n=this.parseBlock(this.gpsOffset,"gps"),e.abrupt("return",(n&&n.has(2)&&n.has(4)&&(n.set("latitude",Ge.apply(void 0,t(n.get(2)).concat([n.get(1)]))),n.set("longitude",Ge.apply(void 0,t(n.get(4)).concat([n.get(3)])))),n));case 10:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"parseInteropBlock",value:(s=S(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!this.interop,!e.t0){e.next=11;break}if(e.t1=this.ifd0,e.t1){e.next=6;break}return e.next=6,this.parseIfd0Block();case 6:if(e.t2=void 0!==this.interopOffset||this.exif,e.t2){e.next=10;break}return e.next=10,this.parseExifBlock();case 10:e.t0=void 0!==this.interopOffset;case 11:if(!e.t0){e.next=13;break}return e.abrupt("return",this.parseBlock(this.interopOffset,"interop"));case 13:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"parseThumbnailBlock",value:(o=S(y().mark((function e(){var t,n=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]&&n[0],this.ifd1||this.ifd1Parsed||this.options.mergeOutput&&!t){e.next=3;break}return e.abrupt("return",(this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1));case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"extractThumbnail",value:(i=S(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.headerParsed||this.parseHeader(),e.t0=this.ifd1Parsed,e.t0){e.next=5;break}return e.next=5,this.parseThumbnailBlock(!0);case 5:if(void 0!==this.ifd1){e.next=7;break}return e.abrupt("return");case 7:return t=this.ifd1.get(513),n=this.ifd1.get(514),e.abrupt("return",this.chunk.getUint8Array(t,n));case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"image",get:function(){return this.ifd0}},{key:"thumbnail",get:function(){return this.ifd1}},{key:"createOutput",value:function(){for(var e,t,n,i={},r=0,a=fe;r<a.length;r++)if(!F(e=this[t=a[r]]))if(n=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(i,n)}else i[t]=n;return this.makerNote&&(i.makerNote=this.makerNote),this.userComment&&(i.userComment=this.userComment),i}},{key:"assignToOutput",value:function(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(var i=0,r=Object.entries(t);i<r.length;i++){var a=n(r[i],2),o=a[0],s=a[1];this.assignObjectToOutput(e,o,s)}}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}}]),d}(Ee);function Ge(e,t,n,i){var r=e+t/60+n/3600;return"S"!==i&&"W"!==i||(r*=-1),r}O(Fe,"type","tiff"),O(Fe,"headerLength",10),X.set("tiff",Fe);var Ue={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};function Be(e){return Ne.apply(this,arguments)}function Ne(){return Ne=S(y().mark((function e(t){var n,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.thumbnail(t);case 2:if(void 0===(n=e.sent)){e.next=6;break}return i=new Blob([n]),e.abrupt("return",URL.createObjectURL(i));case 6:case"end":return e.stop()}}),e,this)}))),Ne.apply(this,arguments)}if(Object.assign({},Ue,{firstChunkSize:4e4,gps:[1,2,3,4]}),Object.assign({},Ue,{tiff:!1,ifd1:!0,mergeOutput:!1}),Object.assign({},Ue,{firstChunkSize:4e4,ifd0:[274]}),"object"==("undefined"==typeof navigator?"undefined":e(navigator))){var je=navigator.userAgent;je.includes("iPad")||je.includes("iPhone")?je.match(/OS (\d+)_(\d+)/):je.includes("OS X 10")&&je.match(/OS X 10[_.](\d+)/),je.includes("Chrome/")?je.match(/Chrome\/(\d+)/):je.includes("Firefox/")&&je.match(/Firefox\/(\d+)/)}var Ve=function(e){r(o,e);var t,n=a(o);function o(){var e;p(this,o);for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return O(s(e=n.call.apply(n,[this].concat(i))),"ranges",new He),0!==e.byteLength&&e.ranges.add(0,e.byteLength),e}return g(o,[{key:"_tryExtend",value:function(e,t,n){if(0===e&&0===this.byteLength&&n){var i=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(i)}else{var r=e+t;if(r>this.byteLength){var a=this._extend(r).dataView;this._swapDataView(a)}}}},{key:"_extend",value:function(e){var t;t=I?x.allocUnsafe(e):new Uint8Array(e);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}},{key:"subarray",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=t||this._lengthToEnd(e),n&&this._tryExtend(e,t),this.ranges.add(e,t),i(h(o.prototype),"subarray",this).call(this,e,t)}},{key:"set",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this._tryExtend(t,e.byteLength,e);var n=i(h(o.prototype),"set",this).call(this,e,t);return this.ranges.add(t,n.byteLength),n}},{key:"ensureChunk",value:(t=S(y().mark((function e(t,n){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.chunked,!e.t0){e.next=6;break}if(e.t1=this.ranges.available(t,n),e.t1){e.next=6;break}return e.next=6,this.readChunk(t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"available",value:function(e,t){return this.ranges.available(e,t)}}]),o}(H),He=function(){function e(){p(this,e),O(this,"list",[])}return g(e,[{key:"length",get:function(){return this.list.length}},{key:"add",value:function(e,n){var i=e+n,r=this.list.filter((function(t){return ze(e,t.offset,i)||ze(e,t.end,i)}));if(r.length>0){e=Math.min.apply(Math,[e].concat(t(r.map((function(e){return e.offset}))))),i=Math.max.apply(Math,[i].concat(t(r.map((function(e){return e.end}))))),n=i-e;var a=r.shift();a.offset=e,a.length=n,a.end=i,this.list=this.list.filter((function(e){return!r.includes(e)}))}else this.list.push({offset:e,length:n,end:i})}},{key:"available",value:function(e,t){var n=e+t;return this.list.some((function(t){return t.offset<=e&&n<=t.end}))}}]),e}();function ze(e,t,n){return e<=t&&t<=n}var _e=function(e){r(l,e);var t,n,i,o,u=a(l);function l(e,t){var n;return p(this,l),O(s(n=u.call(this,0)),"chunksRead",0),n.input=e,n.options=t,n}return g(l,[{key:"readWhole",value:(o=S(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chunked=!1,e.next=3,this.readChunk(this.nextChunkOffset);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"readChunked",value:(i=S(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chunked=!0,e.next=3,this.readChunk(0,this.options.firstChunkSize);case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"readNextChunk",value:(n=S(y().mark((function e(){var t,n,i,r=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:this.nextChunkOffset,!this.fullyRead){e.next=3;break}return e.abrupt("return",(this.chunksRead++,!1));case 3:return n=this.options.chunkSize,e.next=6,this.readChunk(t,n);case 6:return i=e.sent,e.abrupt("return",!!i&&i.byteLength===n);case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"readChunk",value:(t=S(y().mark((function e(t,n){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.chunksRead++,0===(n=this.safeWrapAddress(t,n))){e.next=2;break}return e.abrupt("return",this._readChunk(t,n));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"safeWrapAddress",value:function(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}},{key:"nextChunkOffset",get:function(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}},{key:"canReadNextChunk",get:function(){return this.chunksRead<this.options.chunkLimit}},{key:"fullyRead",get:function(){return void 0!==this.size&&this.nextChunkOffset===this.size}},{key:"read",value:function(){return this.options.chunked?this.readChunked():this.readWhole()}},{key:"close",value:function(){}}]),l}(Ve);K.set("blob",function(e){r(s,e);var t,n,o=a(s);function s(){return p(this,s),o.apply(this,arguments)}return g(s,[{key:"readWhole",value:(n=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chunked=!1,e.next=3,te(this.input);case 3:t=e.sent,this._swapArrayBuffer(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"readChunked",value:function(){return this.chunked=!0,this.size=this.input.size,i(h(s.prototype),"readChunked",this).call(this)}},{key:"_readChunk",value:(t=S(y().mark((function e(t,n){var i,r,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n?t+n:void 0,r=this.input.slice(t,i),e.next=4,te(r);case 4:return a=e.sent,e.abrupt("return",this.set(a,t,!0));case 6:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),s}(_e)),K.set("url",function(e){r(o,e);var t,n,i=a(o);function o(){return p(this,o),i.apply(this,arguments)}return g(o,[{key:"readWhole",value:(n=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chunked=!1,e.next=3,ee(this.input);case 3:(t=e.sent)instanceof ArrayBuffer?this._swapArrayBuffer(t):t instanceof Uint8Array&&this._swapBuffer(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_readChunk",value:(t=S(y().mark((function e(t,n){var i,r,a,o,s;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n?t+n-1:void 0,r=this.options.httpHeaders||{},(t||i)&&(r.range="bytes=".concat([t,i].join("-"))),e.next=4,D(this.input,{headers:r});case 4:return a=e.sent,e.next=7,a.arrayBuffer();case 7:if(o=e.sent,s=o.byteLength,416===a.status){e.next=11;break}return e.abrupt("return",(s!==n&&(this.size=t+s),this.set(o,t,!0)));case 11:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),o}(_e)),H.prototype.getUint64=function(t){var n=this.getUint32(t),i=this.getUint32(t+4);return n<1048575?n<<32|i:void 0!==e(w)?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),w(n)<<w(32)|w(i)):void G("Trying to read 64b value but JS can only handle 53b numbers.")};var We=function(e){r(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n,[{key:"parseBoxes",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=[];e<this.file.byteLength-4;){var n=this.parseBoxHead(e);if(t.push(n),0===n.length)break;e+=n.length}return t}},{key:"parseSubBoxes",value:function(e){e.boxes=this.parseBoxes(e.start)}},{key:"findBox",value:function(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((function(e){return e.kind===t}))}},{key:"parseBoxHead",value:function(e){var t=this.file.getUint32(e),n=this.file.getString(e+4,4),i=e+8;return 1===t&&(t=this.file.getUint64(e+8),i+=8),{offset:e,length:t,kind:n,start:i}}},{key:"parseBoxFullHead",value:function(e){if(void 0===e.version){var t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}}]),n}(Le),Xe=function(e){r(l,e);var t,i,o,s,u=a(l);function l(){return p(this,l),u.apply(this,arguments)}return g(l,[{key:"parse",value:(s=S(y().mark((function e(){var t,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.file.getUint32(0),n=this.parseBoxHead(t);case 1:if("meta"===n.kind){e.next=8;break}return t+=n.length,e.next=5,this.file.ensureChunk(t,16);case 5:n=this.parseBoxHead(t);case 6:e.next=1;break;case 8:return e.next=10,this.file.ensureChunk(n.offset,n.length);case 10:if(this.parseBoxFullHead(n),this.parseSubBoxes(n),e.t0=this.options.icc.enabled,!e.t0){e.next=16;break}return e.next=16,this.findIcc(n);case 16:if(e.t1=this.options.tiff.enabled,!e.t1){e.next=20;break}return e.next=20,this.findExif(n);case 20:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"registerSegment",value:(o=S(y().mark((function e(t,n,i){var r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.file.ensureChunk(n,i);case 2:r=this.file.subarray(n,i),this.createParser(t,r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return o.apply(this,arguments)})},{key:"findIcc",value:(i=S(y().mark((function e(t){var n,i,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(n=this.findBox(t,"iprp"))){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(i=this.findBox(n,"ipco"))){e.next=6;break}return e.abrupt("return");case 6:if(r=this.findBox(i,"colr"),e.t0=void 0!==r,!e.t0){e.next=11;break}return e.next=11,this.registerSegment("icc",r.offset+12,r.length);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"findExif",value:(t=S(y().mark((function e(t){var i,r,a,o,s,u,l,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(i=this.findBox(t,"iinf"))){e.next=3;break}return e.abrupt("return");case 3:if(void 0!==(r=this.findBox(t,"iloc"))){e.next=6;break}return e.abrupt("return");case 6:if(a=this.findExifLocIdInIinf(i),void 0!==(o=this.findExtentInIloc(r,a))){e.next=9;break}return e.abrupt("return");case 9:return s=n(o,2),u=s[0],l=s[1],e.next=12,this.file.ensureChunk(u,l);case 12:return c=4+this.file.getUint32(u),u+=c,l-=c,e.next=17,this.registerSegment("tiff",u,l);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"findExifLocIdInIinf",value:function(e){this.parseBoxFullHead(e);var t,n,i,r=e.start,a=this.file.getUint16(r);for(r+=2;a--;){if(t=this.parseBoxHead(r),this.parseBoxFullHead(t),n=t.start,t.version>=2&&(i=3===t.version?4:2,"Exif"===this.file.getString(n+i+2,4)))return this.file.getUintBytes(n,i);r+=t.length}}},{key:"get8bits",value:function(e){var t=this.file.getUint8(e);return[t>>4,15&t]}},{key:"findExtentInIloc",value:function(e,t){this.parseBoxFullHead(e);var i=e.start,r=n(this.get8bits(i++),2),a=r[0],o=r[1],s=n(this.get8bits(i++),2),u=s[0],l=s[1],c=2===e.version?4:2,f=1===e.version||2===e.version?2:0,h=l+a+o,p=2===e.version?4:2,d=this.file.getUintBytes(i,p);for(i+=p;d--;){var g=this.file.getUintBytes(i,c);i+=c+f+2+u;var m=this.file.getUint16(i);if(i+=2,g===t)return m>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(i+l,a),this.file.getUintBytes(i+l+a,o)];i+=m*h}}}],[{key:"canHandle",value:function(e,t){if(0!==t)return!1;var n=e.getUint16(2);if(n>50)return!1;for(var i=16,r=[];i<n;)r.push(e.getString(i,4)),i+=4;return r.includes(this.type)}}]),l}(We),Ke=function(e){r(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n)}(Xe);O(Ke,"type","heic");var Je=function(e){r(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n)}(Xe);O(Je,"type","avif"),W.set("heic",Ke),W.set("avif",Je),ie(ae,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),ie(ae,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),ie(ae,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),ie(oe,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);var Ye=ie(oe,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]),qe={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Ye.set(37392,qe),Ye.set(41488,qe);var Qe={0:"Normal",1:"Low",2:"High"};function Ze(t){return"object"==e(t)&&void 0!==t.length?t[0]:t}function $e(e){var t=Array.from(e).slice(1);return t[1]>15&&(t=t.map((function(e){return String.fromCharCode(e)}))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function et(e){if("string"==typeof e){var t=n(e.trim().split(/[-: ]/g).map(Number),6),i=t[0],r=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=new Date(i,r-1,a);return Number.isNaN(o)||Number.isNaN(s)||Number.isNaN(u)||(l.setHours(o),l.setMinutes(s),l.setSeconds(u)),Number.isNaN(+l)?e:l}}function tt(e){if("string"==typeof e)return e;var t=[];if(0===e[1]&&0===e[e.length-1])for(var n=0;n<e.length;n+=2)t.push(nt(e[n+1],e[n]));else for(var i=0;i<e.length;i+=2)t.push(nt(e[i],e[i+1]));return U(String.fromCodePoint.apply(String,t))}function nt(e,t){return e<<8|t}Ye.set(41992,Qe),Ye.set(41993,Qe),Ye.set(41994,Qe),ie(se,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?V(e):e}],[306,et],[40091,tt],[40092,tt],[40093,tt],[40094,tt],[40095,tt]]),ie(se,"exif",[[40960,$e],[36864,$e],[36867,et],[36868,et],[40962,Ze],[40963,Ze]]),ie(se,"gps",[[0,function(e){return Array.from(e).join(".")}],[7,function(e){return Array.from(e).join(":")}]]);var it=function(e){r(o,e);var t=a(o);function o(){return p(this,o),t.apply(this,arguments)}return g(o,[{key:"normalizeInput",value:function(e){return"string"==typeof e?e:H.from(e).getString()}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chunk;if(!this.localOptions.parse)return e;e=function(e){var t,n={},i={},r=k(ht);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a]=[],i[a]=0}}catch(o){r.e(o)}finally{r.f()}return e.replace(pt,(function(e,t,r){if("<"===t){var a=++i[r];return n[r].push(a),"".concat(e,"#").concat(a)}return"".concat(e,"#").concat(n[r].pop())}))}(e);var t=at.findAll(e,"rdf","Description");0===t.length&&t.push(new at("rdf","Description",void 0,e));var n,i={},r=k(t);try{for(r.s();!(n=r.n()).done;){var a,o=k(n.value.properties);try{for(o.s();!(a=o.n()).done;){var s=a.value;ot(s,lt(s.ns,i))}}catch(u){o.e(u)}finally{o.f()}}}catch(u){r.e(u)}finally{r.f()}return function(e){for(var t in e)void 0===(e[t]=M(e[t]))&&delete e[t];return M(e)}(i)}},{key:"assignToOutput",value:function(e,t){if(this.localOptions.parse)for(var i=0,r=Object.entries(t);i<r.length;i++){var a=n(r[i],2),o=a[0],s=a[1];switch(o){case"tiff":this.assignObjectToOutput(e,"ifd0",s);break;case"exif":this.assignObjectToOutput(e,"exif",s);break;case"xmlns":break;default:this.assignObjectToOutput(e,o,s)}}else e.xmp=t}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&"http://ns.adobe.com/"===e.getString(t+4,20)}},{key:"headerLength",value:function(e,t){return"http://ns.adobe.com/xmp/extension/"===e.getString(t+4,34)?79:33}},{key:"findPosition",value:function(e,t){var n=i(h(o),"findPosition",this).call(this,e,t);return n.multiSegment=n.extended=79===n.headerLength,n.multiSegment?(n.chunkCount=e.getUint8(t+72),n.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&n.chunkNumber++):(n.chunkCount=1/0,n.chunkNumber=-1),n}},{key:"handleMultiSegments",value:function(e){return e.map((function(e){return e.chunk.getString()})).join("")}}]),o}(Te);O(it,"type","xmp"),O(it,"multiSegment",!0),X.set("xmp",it);var rt=function(){function e(t,n,i){p(this,e),this.ns=t,this.name=n,this.value=i}return g(e,[{key:"serialize",value:function(){return this.value}}],[{key:"findAll",value:function(t){return ct(t,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(e.unpackMatch)}},{key:"unpackMatch",value:function(t){var n=t[1],i=t[2],r=t[3].slice(1,-1);return new e(n,i,r=ft(r))}}]),e}(),at=function(){function e(n,i,r,a){p(this,e),this.ns=n,this.name=i,this.attrString=r,this.innerXml=a,this.attrs=rt.findAll(r),this.children=e.findAll(a),this.value=0===this.children.length?ft(a):void 0,this.properties=[].concat(t(this.attrs),t(this.children))}return g(e,[{key:"isPrimitive",get:function(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}},{key:"isListContainer",get:function(){return 1===this.children.length&&this.children[0].isList}},{key:"isList",get:function(){var e=this.ns,t=this.name;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}},{key:"isListItem",get:function(){return"rdf"===this.ns&&"li"===this.name}},{key:"serialize",value:function(){if(0!==this.properties.length||void 0!==this.value){if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return ut(this.children.map(st));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();var e,t={},n=k(this.properties);try{for(n.s();!(e=n.n()).done;){ot(e.value,t)}}catch(i){n.e(i)}finally{n.f()}return void 0!==this.value&&(t.value=this.value),M(t)}}}],[{key:"findAll",value:function(t,n,i){if(void 0!==n||void 0!==i){n=n||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var r=new RegExp("<(".concat(n,"):(").concat(i,")(#\\d+)?((\\s+?[\\w\\d-:]+=(\"[^\"]*\"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)"),"gm")}else r=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return ct(t,r).map(e.unpackMatch)}},{key:"unpackMatch",value:function(t){return new e(t[1],t[2],t[4],t[8])}}]),e}();function ot(e,t){var n=e.serialize();void 0!==n&&(t[e.name]=n)}var st=function(e){return e.serialize()},ut=function(e){return 1===e.length?e[0]:e},lt=function(e,t){return t[e]?t[e]:t[e]={}};function ct(e,t){var n,i=[];if(!e)return i;for(;null!==(n=t.exec(e));)i.push(n);return i}function ft(e){if(!function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e)){var t=Number(e);if(!Number.isNaN(t))return t;var n=e.toLowerCase();return"true"===n||"false"!==n&&e.trim()}}var ht=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],pt=new RegExp("(<|\\/)(".concat(ht.join("|"),")"),"g"),dt=T("fs",(function(e){return e.promises}));K.set("fs",function(e){r(l,e);var t,n,i,o,s,u=a(l);function l(){return p(this,l),u.apply(this,arguments)}return g(l,[{key:"readWhole",value:(s=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chunked=!1,e.next=3,dt;case 3:return this.fs=e.sent,e.next=6,this.fs.readFile(this.input);case 6:t=e.sent,this._swapBuffer(t);case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"readChunked",value:(o=S(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.chunked=!0,e.next=3,dt;case 3:return this.fs=e.sent,e.next=6,this.open();case 6:return e.next=8,this.readChunk(0,this.options.firstChunkSize);case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"open",value:(i=S(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=void 0===this.fh,!e.t0){e.next=8;break}return e.next=4,this.fs.open(this.input,"r");case 4:return this.fh=e.sent,e.next=7,this.fh.stat(this.input);case 7:this.size=e.sent.size;case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_readChunk",value:(n=S(y().mark((function e(t,n){var i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=void 0===this.fh,!e.t0){e.next=4;break}return e.next=4,this.open();case 4:return t+n>this.size&&(n=this.size-t),i=this.subarray(t,n,!0),e.next=8,this.fh.read(i.dataView,0,n,t);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"close",value:(t=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.fh){e.next=5;break}return t=this.fh,this.fh=void 0,e.next=5,t.close();case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),l}(_e)),K.set("base64",function(e){r(i,e);var t,n=a(i);function i(){var e;p(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return(e=n.call.apply(n,[this].concat(r))).input=e.input.replace(/^data:([^;]+);base64,/gim,""),e.size=e.input.length/4*3,e.input.endsWith("==")?e.size-=2:e.input.endsWith("=")&&(e.size-=1),e}return g(i,[{key:"_readChunk",value:(t=S(y().mark((function e(t,n){var i,r,a,o,s,u,l,c,f,h,p;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.input,void 0===t?(t=0,i=0,r=0):(i=4*Math.floor(t/3),r=t-i/4*3),void 0===n&&(n=this.size),o=t+n,s=i+4*Math.ceil(o/3),a=a.slice(i,s),u=Math.min(n,this.size-t),!I){e.next=8;break}return l=x.from(a,"base64").slice(r,r+u),e.abrupt("return",this.set(l,t,!0));case 8:for(c=this.subarray(t,u,!0),f=atob(a),h=c.toUint8(),p=0;p<u;p++)h[p]=f.charCodeAt(r+p);return e.abrupt("return",c);case 11:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),i}(_e));var gt=function(e){r(i,e);var t,n=a(i);function i(){return p(this,i),n.apply(this,arguments)}return g(i,[{key:"extendOptions",value:function(e){var t=e.ifd0,n=e.xmp,i=e.iptc,r=e.icc;n.enabled&&t.deps.add(700),i.enabled&&t.deps.add(33723),r.enabled&&t.deps.add(34675),t.finalizeFilters()}},{key:"parse",value:(t=S(y().mark((function e(){var t,n,i,r,a,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.options,n=t.tiff,i=t.xmp,r=t.iptc,a=t.icc,!(n.enabled||i.enabled||r.enabled||a.enabled)){e.next=12;break}return o=Math.max(B(this.options),this.options.chunkSize),e.next=5,this.file.ensureChunk(0,o);case 5:return this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),e.next=9,this.parsers.tiff.parseIfd0Block();case 9:this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc");case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"adaptTiffPropAsSegment",value:function(e){if(this.parsers.tiff[e]){var t=this.parsers.tiff[e];this.injectSegment(e,t)}}}],[{key:"canHandle",value:function(e,t){return 18761===t||19789===t}}]),i}(Le);O(gt,"type","tiff"),W.set("tiff",gt);var mt=T("zlib"),yt=["ihdr","iccp","text","itxt","exif"],vt=function(e){r(f,e);var t,i,o,u,l,c=a(f);function f(){var e;p(this,f);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return O(s(e=c.call.apply(c,[this].concat(n))),"catchError",(function(t){return e.errors.push(t)})),O(s(e),"metaChunks",[]),O(s(e),"unknownChunks",[]),e}return g(f,[{key:"parse",value:(l=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.file,e.next=3,this.findPngChunksInRange(8,t.byteLength);case 3:return e.next=5,this.readSegments(this.metaChunks);case 5:return this.findIhdr(),this.parseTextChunks(),e.next=9,this.findExif().catch(this.catchError);case 9:return e.next=11,this.findXmp().catch(this.catchError);case 11:return e.next=13,this.findIcc().catch(this.catchError);case 13:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"findPngChunksInRange",value:(u=S(y().mark((function e(t,n){var i,r,a,o,s,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=this.file;t<n;)r=i.getUint32(t),a=i.getUint32(t+4),o=i.getString(t+4,4).toLowerCase(),u={type:o,offset:t,length:s=r+4+4+4,start:t+4+4,size:r,marker:a},yt.includes(o)?this.metaChunks.push(u):this.unknownChunks.push(u),t+=s;case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"parseTextChunks",value:function(){var e,t=k(this.metaChunks.filter((function(e){return"text"===e.type})));try{for(t.s();!(e=t.n()).done;){var i=e.value,r=n(this.file.getString(i.start,i.size).split("\0"),2),a=r[0],o=r[1];this.injectKeyValToIhdr(a,o)}}catch(s){t.e(s)}finally{t.f()}}},{key:"injectKeyValToIhdr",value:function(e,t){var n=this.parsers.ihdr;n&&n.raw.set(e,t)}},{key:"findIhdr",value:function(){var e=this.metaChunks.find((function(e){return"ihdr"===e.type}));e&&!1!==this.options.ihdr.enabled&&this.createParser("ihdr",e.chunk)}},{key:"findExif",value:(o=S(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.metaChunks.find((function(e){return"exif"===e.type})))&&this.injectSegment("tiff",t.chunk);case 2:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"findXmp",value:(i=S(y().mark((function e(){var t,n,i,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.metaChunks.filter((function(e){return"itxt"===e.type})),n=k(t);try{for(n.s();!(i=n.n()).done;)"XML:com.adobe.xmp"===(r=i.value).chunk.getString(0,17)&&this.injectSegment("xmp",r.chunk)}catch(a){n.e(a)}finally{n.f()}case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"findIcc",value:(t=S(y().mark((function e(){var t,n,i,r,a,o,s,u;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.metaChunks.find((function(e){return"iccp"===e.type}))){e.next=3;break}return e.abrupt("return");case 3:for(n=t.chunk,i=n.getUint8Array(0,81),r=0;r<80&&0!==i[r];)r++;if(a=r+2,o=n.getString(0,r),this.injectKeyValToIhdr("ProfileName",o),!P){e.next=12;break}return e.next=9,mt;case 9:s=e.sent,u=n.getUint8Array(a),u=s.inflateSync(u),this.injectSegment("icc",u);case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"canHandle",value:function(e,t){return 35152===t&&2303741511===e.getUint32(0)&&218765834===e.getUint32(4)}}]),f}(Le);O(vt,"type","png"),W.set("png",vt),ie(ae,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),re(ae,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);var St=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];re(ae,"ifd0",St),re(ae,"exif",St),ie(oe,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);var kt=function(e){r(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n,[{key:"parse",value:function(){return this.parseTags(),this.translate(),this.output}},{key:"parseTags",value:function(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}],[{key:"canHandle",value:function(e,t){return 224===e.getUint8(t+1)&&1246120262===e.getUint32(t+4)&&0===e.getUint8(t+8)}}]),n}(Te);O(kt,"type","jfif"),O(kt,"headerLength",9),X.set("jfif",kt),ie(ae,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);var bt=function(e){r(i,e);var n=a(i);function i(){return p(this,i),n.apply(this,arguments)}return g(i,[{key:"parse",value:function(){return this.parseTags(),this.translate(),this.output}},{key:"parseTags",value:function(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)]].concat(t(Array.from(this.raw))))}}]),i}(Te);O(bt,"type","ihdr"),X.set("ihdr",bt),ie(ae,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),ie(oe,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);var Ct=function(e){r(o,e);var t=a(o);function o(){return p(this,o),t.apply(this,arguments)}return g(o,[{key:"parse",value:function(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}},{key:"parseHeader",value:function(){var e=this.raw;this.chunk.byteLength<84&&G("ICC header is too short");for(var t=0,i=Object.entries(Pt);t<i.length;t++){var r=n(i[t],2),a=r[0],o=r[1];a=parseInt(a,10);var s=o(this.chunk,a);"\0\0\0\0"!==s&&e.set(a,s)}}},{key:"parseTags",value:function(){for(var e,t,n,i,r,a=this.raw,o=this.chunk.getUint32(128),s=132,u=this.chunk.byteLength;o--;){if(e=this.chunk.getString(s,4),t=this.chunk.getUint32(s+4),n=this.chunk.getUint32(s+8),i=this.chunk.getString(t,4),t+n>u)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");void 0!==(r=this.parseTag(i,t,n))&&"\0\0\0\0"!==r&&a.set(e,r),s+=12}}},{key:"parseTag",value:function(e,t,n){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,n);case"sig ":return this.parseSig(t)}if(!(t+n>this.chunk.byteLength))return this.chunk.getUint8Array(t,n)}},{key:"parseDesc",value:function(e){var t=this.chunk.getUint32(e+8)-1;return U(this.chunk.getString(e+12,t))}},{key:"parseText",value:function(e,t){return U(this.chunk.getString(e+8,t-8))}},{key:"parseSig",value:function(e){return U(this.chunk.getString(e+8,4))}},{key:"parseMluc",value:function(e){for(var t=this.chunk,n=t.getUint32(e+8),i=t.getUint32(e+12),r=e+16,a=[],o=0;o<n;o++){var s=t.getString(r+0,2),u=t.getString(r+2,2),l=t.getUint32(r+4),c=t.getUint32(r+8)+e,f=U(t.getUnicodeString(c,l));a.push({lang:s,country:u,text:f}),r+=i}return 1===n?a[0].text:a}},{key:"translateValue",value:function(e,t){return"string"==typeof e?t[e]||t[e.toLowerCase()]||e:t[e]||e}}],[{key:"canHandle",value:function(e,t){return 226===e.getUint8(t+1)&&1229144927===e.getUint32(t+4)}},{key:"findPosition",value:function(e,t){var n=i(h(o),"findPosition",this).call(this,e,t);return n.chunkNumber=e.getUint8(t+16),n.chunkCount=e.getUint8(t+17),n.multiSegment=n.chunkCount>1,n}},{key:"handleMultiSegments",value:function(e){return function(e){var t=function(e){var t,n=e[0].constructor,i=0,r=k(e);try{for(r.s();!(t=r.n()).done;){i+=t.value.length}}catch(c){r.e(c)}finally{r.f()}var a,o=new n(i),s=0,u=k(e);try{for(u.s();!(a=u.n()).done;){var l=a.value;o.set(l,s),s+=l.length}}catch(c){u.e(c)}finally{u.f()}return o}(e.map((function(e){return e.chunk.toUint8()})));return new H(t)}(e)}}]),o}(Te);O(Ct,"type","icc"),O(Ct,"multiSegment",!0),O(Ct,"headerLength",18);var Pt={4:xt,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map((function(e){return e.toString(10)})).join(".")},12:xt,16:xt,20:xt,24:function(e,t){var n=e.getUint16(t),i=e.getUint16(t+2)-1,r=e.getUint16(t+4),a=e.getUint16(t+6),o=e.getUint16(t+8),s=e.getUint16(t+10);return new Date(Date.UTC(n,i,r,a,o,s))},36:xt,40:xt,48:xt,52:xt,64:function(e,t){return e.getUint32(t)},80:xt};function xt(e,t){return U(e.getString(t,4))}X.set("icc",Ct),ie(ae,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);var wt={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},It={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};ie(oe,"icc",[[4,wt],[12,It],[40,Object.assign({},wt,It)],[48,wt],[80,wt],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);var Lt=function(e){r(n,e);var t=a(n);function n(){return p(this,n),t.apply(this,arguments)}return g(n,[{key:"parse",value:function(){for(var e=this.raw,t=this.chunk.byteLength-1,n=!1,i=0;i<t;i++)if(28===this.chunk.getUint8(i)&&2===this.chunk.getUint8(i+1)){n=!0;var r=this.chunk.getUint16(i+3),a=this.chunk.getUint8(i+2),o=this.chunk.getLatin1String(i+5,r);e.set(a,this.pluralizeValue(e.get(a),o)),i+=4+r}else if(n)break;return this.translate(),this.output}},{key:"pluralizeValue",value:function(e,t){return void 0!==e?e instanceof Array?(e.push(t),e):[e,t]:t}}],[{key:"canHandle",value:function(e,t,n){return 237===e.getUint8(t+1)&&"Photoshop"===e.getString(t+4,9)&&void 0!==this.containsIptc8bim(e,t,n)}},{key:"headerLength",value:function(e,t,n){var i,r=this.containsIptc8bim(e,t,n);if(void 0!==r)return(i=e.getUint8(t+r+7))%2!=0&&(i+=1),0===i&&(i=4),r+8+i}},{key:"containsIptc8bim",value:function(e,t,n){for(var i=0;i<n;i++)if(this.isIptcSegmentHead(e,t+i))return i}},{key:"isIptcSegmentHead",value:function(e,t){return 56===e.getUint8(t)&&943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}}]),n}(Te);O(Lt,"type","iptc"),O(Lt,"translateValues",!1),O(Lt,"reviveValues",!1),X.set("iptc",Lt),ie(ae,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),ie(oe,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);var Tt,Dt="/assets/leica-887c663a.svg";window.addEventListener("DOMContentLoaded",(function(){document.querySelector("#fileInput").addEventListener("change",function(){var e=S(y().mark((function e(t){var n,i,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new FileReader,i=t.target.files[0],t.target&&t.target.files.length&&t.target.files[0]){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,we(i,!0);case 6:r=e.sent,console.log(r),n.addEventListener("loadend",function(){var e=S(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new Image,Tt=t.target.result,!/jpg|jpeg|gif|png|tif|tiff|heic/i.test(i.name.split(".")[i.name.split(".").length-1])){e.next=6;break}e.t1=t.target.result.toString(),e.next=9;break;case 6:return e.next=8,Be(i);case 8:e.t1=e.sent;case 9:if(e.t0=e.t1,e.t0){e.next=12;break}e.t0="undefined";case 12:n.src=e.t0,"undefined"==n.src&&alert("不受支持的图片格式!"),n.addEventListener("load",(function(){var e=document.querySelector("canvas#canvas"),t=e.getContext("2d"),a=.15*n.height;e.height=n.height+a,e.width=n.width,t.fillStyle="#FFF",t.fillRect(0,0,e.width,e.height),t.drawImage(n,0,0);var o,s,u,l,c,f="".concat(r.Make," ").concat(r.Model),h="f/".concat(r.FNumber," ").concat(r.ExposureTime>1?10*Math.round(r.ExposureTime/1)/10:"1/".concat(Math.round(1/r.ExposureTime))," ISO").concat(r.ISO),p=r.DateTimeOriginal||r.CreateDate||r.ModifyDate,g="".concat(null==p?void 0:p.getFullYear(),".").concat(null==p?void 0:p.getMonth(),".").concat(null==p?void 0:p.getDate()," ").concat(null==p?void 0:p.getHours(),":").concat(null==p?void 0:p.getMinutes(),":").concat(null==p?void 0:p.getSeconds());r.GPSLatitude&&r.GPSLongitude&&(o="".concat(r.GPSLatitude[0],"°").concat(r.GPSLatitude[1],"′").concat(Math.round(r.GPSLatitude[2]),"″").concat(r.GPSLatitudeRef||"","  ").concat(r.GPSLongitude[0],"°").concat(r.GPSLongitude[1],"′").concat(Math.round(r.GPSLongitude[2]),"″").concat(r.GPSLongitudeRef||"")),s=f,t.fillStyle="#000",t.font="bold ".concat(.2*a,"px 'MiSans'"),t.textBaseline="top",t.textAlign="left",t.fillText(s,.3*a,n.height+.3*a),u=h,t.fillStyle="#000",t.font="bold ".concat(.2*a,"px 'MiSans'"),t.textBaseline="top",t.textAlign="right",t.fillText(u,n.width-.3*a,n.height+.3*a),l=g,c=o,t.fillStyle="#737373",t.font="".concat(.17*a,"px 'MiSans'"),t.textBaseline="top",t.textAlign="right",void 0!==c?(t.fillText(c,n.width-.3*a,n.height+.55*a),t.textAlign="left",t.fillText(l,.3*a,n.height+.55*a)):t.fillText(l,n.width-.3*a,n.height+.55*a),function(){t.fillStyle="#d3d3d3",t.textBaseline="top",t.textAlign="left",t.font="bold ".concat(.2*a,"px 'MiSans'");var e=t.measureText(h).width;t.font="bold ".concat(.17*a,"px 'MiSans'");var i=t.measureText(o||g).width;t.fillRect(n.width-Math.max(e,i)-.3*a-.01*n.width,n.height+.28*a,-.0025*n.width,.425*a)}(),function(){var e=new Image,i=Dt;switch(r.Make){case"SONY":i="/assets/Sony-c5ac1b64.svg";break;case"Canon":i="/assets/Canon-9b6acea0.svg";break;case"NIKON CORPORATION":i="/assets/Nikon_2003-f5731c81.svg";break;case"FUJIFILM":i="/assets/Fujifilm_2006-b864405e.svg";break;case"Panasonic":i="/assets/Panasonic-37428438.svg";break;case"OM Digital Solutions":i="/assets/Olympus_Corporation_logo-73482387.svg";break;default:i=Dt}e.src=i,e.addEventListener("load",(function(){t.font="bold ".concat(.2*a,"px 'MiSans'");var i=t.measureText(h).width;t.font="bold ".concat(.17*a,"px 'MiSans'");var r=t.measureText(o||g).width,s=.425*a,u=s*(e.width/e.height);t.drawImage(e,n.width-Math.max(i,r)-.3*a-.02*n.width-u,n.height+.28*a,u,s)}))}(),document.querySelector("#saveImageBtn").addEventListener("click",(function(){var t=d.load(Tt);t["0th"][d.ImageIFD.ProcessingSoftware]="Leica Generator by Yuameshi",t["0th"][d.ImageIFD.Software]="Leica Generator by Yuameshi";var n=d.dump(t),r=document.createElement("a");r.href=d.insert(n,e.toDataURL("image/jpeg",1)),r.download="".concat(i.name,"-Leica.jpg"),r.click()}))}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.readAsDataURL(i);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}}}))}();
