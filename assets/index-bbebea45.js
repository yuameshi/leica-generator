function wi(){import.meta.url,import("_").catch(()=>1);async function*a(){}}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();var ze={exports:{}};(function(a,e){(function(){var t={};t.version="1.0.4",t.remove=function(o){var h=!1;if(o.slice(0,2)!="ÿØ")if(o.slice(0,23)=="data:image/jpeg;base64,"||o.slice(0,22)=="data:image/jpg;base64,")o=T(o.split(",")[1]),h=!0;else throw new Error("Given data is not jpeg.");var f=D(o),u=f.filter(function(c){return!(c.slice(0,2)=="ÿá"&&c.slice(4,10)=="Exif\0\0")}),d=u.join("");return h&&(d="data:image/jpeg;base64,"+m(d)),d},t.insert=function(o,h){var f=!1;if(o.slice(0,6)!="Exif\0\0")throw new Error("Given data is not exif.");if(h.slice(0,2)!="ÿØ")if(h.slice(0,23)=="data:image/jpeg;base64,"||h.slice(0,22)=="data:image/jpg;base64,")h=T(h.split(",")[1]),f=!0;else throw new Error("Given data is not jpeg.");var u="ÿá"+S(">H",[o.length+2])+o,d=D(h),c=Ae(d,u);return f&&(c="data:image/jpeg;base64,"+m(c)),c},t.load=function(o){var h;if(typeof o=="string")if(o.slice(0,2)=="ÿØ")h=o;else if(o.slice(0,23)=="data:image/jpeg;base64,"||o.slice(0,22)=="data:image/jpg;base64,")h=T(o.split(",")[1]);else if(o.slice(0,4)=="Exif")h=o.slice(6);else throw new Error("'load' gots invalid file data.");else throw new Error("'load' gots invalid type argument.");var f={"0th":{},Exif:{},GPS:{},Interop:{},"1st":{},thumbnail:null},u=new P(h);if(u.tiftag===null)return f;u.tiftag.slice(0,2)=="II"?u.endian_mark="<":u.endian_mark=">";var d=C(u.endian_mark+"L",u.tiftag.slice(4,8))[0];f["0th"]=u.get_ifd(d,"0th");var c=f["0th"].first_ifd_pointer;if(delete f["0th"].first_ifd_pointer,34665 in f["0th"]&&(d=f["0th"][34665],f.Exif=u.get_ifd(d,"Exif")),34853 in f["0th"]&&(d=f["0th"][34853],f.GPS=u.get_ifd(d,"GPS")),40965 in f.Exif&&(d=f.Exif[40965],f.Interop=u.get_ifd(d,"Interop")),c!="\0\0\0\0"&&(d=C(u.endian_mark+"L",c)[0],f["1st"]=u.get_ifd(d,"1st"),513 in f["1st"]&&514 in f["1st"])){var g=f["1st"][513]+f["1st"][514],v=u.tiftag.slice(f["1st"][513],g);f.thumbnail=v}return f},t.dump=function(o){var h=8,f=i(o),u="Exif\0\0MM\0*\0\0\0\b",d=!1,c=!1,g=!1,v=!1,I,x,L,k,Q;"0th"in f?I=f["0th"]:I={},"Exif"in f&&Object.keys(f.Exif).length||"Interop"in f&&Object.keys(f.Interop).length?(I[34665]=1,d=!0,x=f.Exif,"Interop"in f&&Object.keys(f.Interop).length?(x[40965]=1,g=!0,L=f.Interop):Object.keys(x).indexOf(t.ExifIFD.InteroperabilityTag.toString())>-1&&delete x[40965]):Object.keys(I).indexOf(t.ImageIFD.ExifTag.toString())>-1&&delete I[34665],"GPS"in f&&Object.keys(f.GPS).length?(I[t.ImageIFD.GPSTag]=1,c=!0,k=f.GPS):Object.keys(I).indexOf(t.ImageIFD.GPSTag.toString())>-1&&delete I[t.ImageIFD.GPSTag],"1st"in f&&"thumbnail"in f&&f.thumbnail!=null&&(v=!0,f["1st"][513]=1,f["1st"][514]=1,Q=f["1st"]);var K=y(I,"0th",0),N=K[0].length+d*12+c*12+4+K[1].length,V,ce="",H=0,ue,Oe="",Z=0,at,Me="",Fe=0,ee,rt="",de;if(d&&(V=y(x,"Exif",N),H=V[0].length+g*12+V[1].length),c&&(ue=y(k,"GPS",N+H),Oe=ue.join(""),Z=Oe.length),g){var Ee=N+H+Z;at=y(L,"Interop",Ee),Me=at.join(""),Fe=Me.length}if(v){var Ee=N+H+Z+Fe;if(ee=y(Q,"1st",Ee),de=n(f.thumbnail),de.length>64e3)throw new Error("Given thumbnail is too large. max 64kB")}var st="",ot="",lt="",ht="\0\0\0\0";if(d){var _=h+N,te=S(">L",[_]),ie=34665,ne=S(">H",[ie]),ae=S(">H",[j.Long]),re=S(">L",[1]);st=ne+ae+re+te}if(c){var _=h+N+H,te=S(">L",[_]),ie=34853,ne=S(">H",[ie]),ae=S(">H",[j.Long]),re=S(">L",[1]);ot=ne+ae+re+te}if(g){var _=h+N+H+Z,te=S(">L",[_]),ie=40965,ne=S(">H",[ie]),ae=S(">H",[j.Long]),re=S(">L",[1]);lt=ne+ae+re+te}if(v){var _=h+N+H+Z+Fe;ht=S(">L",[_]);var zt=_+ee[0].length+24+4+ee[1].length,_t="\0\0\0\0"+S(">L",[zt]),jt="\0\0\0\0"+S(">L",[de.length]);rt=ee[0]+_t+jt+"\0\0\0\0"+ee[1]+de}var Wt=K[0]+st+ot+ht+K[1];return d&&(ce=V[0]+lt+V[1]),u+Wt+ce+Oe+Me+rt};function i(o){return JSON.parse(JSON.stringify(o))}function n(o){for(var h=D(o);"ÿà"<=h[1].slice(0,2)&&h[1].slice(0,2)<="ÿï";)h=[h[0]].concat(h.slice(2));return h.join("")}function r(o){return S(">"+w("B",o.length),o)}function s(o){return S(">"+w("H",o.length),o)}function l(o){return S(">"+w("L",o.length),o)}function p(o,h,f){var u="",d="",c,g,v,I;if(h=="Byte")c=o.length,c<=4?d=r(o)+w("\0",4-c):(d=S(">L",[f]),u=r(o));else if(h=="Short")c=o.length,c<=2?d=s(o)+w("\0\0",2-c):(d=S(">L",[f]),u=s(o));else if(h=="Long")c=o.length,c<=1?d=l(o):(d=S(">L",[f]),u=l(o));else if(h=="Ascii")g=o+"\0",c=g.length,c>4?(d=S(">L",[f]),u=g):d=g+w("\0",4-c);else if(h=="Rational"){if(typeof o[0]=="number")c=1,v=o[0],I=o[1],g=S(">L",[v])+S(">L",[I]);else{c=o.length,g="";for(var x=0;x<c;x++)v=o[x][0],I=o[x][1],g+=S(">L",[v])+S(">L",[I])}d=S(">L",[f]),u=g}else if(h=="SRational"){if(typeof o[0]=="number")c=1,v=o[0],I=o[1],g=S(">l",[v])+S(">l",[I]);else{c=o.length,g="";for(var x=0;x<c;x++)v=o[x][0],I=o[x][1],g+=S(">l",[v])+S(">l",[I])}d=S(">L",[f]),u=g}else h=="Undefined"&&(c=o.length,c>4?(d=S(">L",[f]),u=o):d=o+w("\0",4-c));var L=S(">L",[c]);return[L,d,u]}function y(o,h,f){var u=8,d=Object.keys(o).length,c=S(">H",[d]),g;["0th","1st"].indexOf(h)>-1?g=2+d*12+4:g=2+d*12;var v="",I="",x;for(var x in o)if(typeof x=="string"&&(x=parseInt(x)),!(h=="0th"&&[34665,34853].indexOf(x)>-1)){{if(h=="Exif"&&x==40965)continue;if(h=="1st"&&[513,514].indexOf(x)>-1)continue}var L=o[x],k=S(">H",[x]),Q=B[h][x].type,K=S(">H",[j[Q]]);typeof L=="number"&&(L=[L]);var N=u+g+f+I.length,V=p(L,Q,N),ce=V[0],H=V[1],ue=V[2];v+=k+K+ce+H,I+=ue}return[c+v,I]}function P(o){var h,f;if(o.slice(0,2)=="ÿØ")h=D(o),f=q(h),f?this.tiftag=f.slice(10):this.tiftag=null;else if(["II","MM"].indexOf(o.slice(0,2))>-1)this.tiftag=o;else if(o.slice(0,4)=="Exif")this.tiftag=o.slice(6);else throw new Error("Given file is neither JPEG nor TIFF.")}if(P.prototype={get_ifd:function(o,h){var f={},u=C(this.endian_mark+"H",this.tiftag.slice(o,o+2))[0],d=o+2,c;["0th","1st"].indexOf(h)>-1?c="Image":c=h;for(var g=0;g<u;g++){o=d+12*g;var v=C(this.endian_mark+"H",this.tiftag.slice(o,o+2))[0],I=C(this.endian_mark+"H",this.tiftag.slice(o+2,o+4))[0],x=C(this.endian_mark+"L",this.tiftag.slice(o+4,o+8))[0],L=this.tiftag.slice(o+8,o+12),k=[I,x,L];v in B[c]&&(f[v]=this.convert_value(k))}return h=="0th"&&(o=d+12*u,f.first_ifd_pointer=this.tiftag.slice(o,o+4)),f},convert_value:function(o){var h=null,f=o[0],u=o[1],d=o[2],c;if(f==1)u>4?(c=C(this.endian_mark+"L",d)[0],h=C(this.endian_mark+w("B",u),this.tiftag.slice(c,c+u))):h=C(this.endian_mark+w("B",u),d.slice(0,u));else if(f==2)u>4?(c=C(this.endian_mark+"L",d)[0],h=this.tiftag.slice(c,c+u-1)):h=d.slice(0,u-1);else if(f==3)u>2?(c=C(this.endian_mark+"L",d)[0],h=C(this.endian_mark+w("H",u),this.tiftag.slice(c,c+u*2))):h=C(this.endian_mark+w("H",u),d.slice(0,u*2));else if(f==4)u>1?(c=C(this.endian_mark+"L",d)[0],h=C(this.endian_mark+w("L",u),this.tiftag.slice(c,c+u*4))):h=C(this.endian_mark+w("L",u),d);else if(f==5)if(c=C(this.endian_mark+"L",d)[0],u>1){h=[];for(var g=0;g<u;g++)h.push([C(this.endian_mark+"L",this.tiftag.slice(c+g*8,c+4+g*8))[0],C(this.endian_mark+"L",this.tiftag.slice(c+4+g*8,c+8+g*8))[0]])}else h=[C(this.endian_mark+"L",this.tiftag.slice(c,c+4))[0],C(this.endian_mark+"L",this.tiftag.slice(c+4,c+8))[0]];else if(f==7)u>4?(c=C(this.endian_mark+"L",d)[0],h=this.tiftag.slice(c,c+u)):h=d.slice(0,u);else if(f==9)u>1?(c=C(this.endian_mark+"L",d)[0],h=C(this.endian_mark+w("l",u),this.tiftag.slice(c,c+u*4))):h=C(this.endian_mark+w("l",u),d);else if(f==10)if(c=C(this.endian_mark+"L",d)[0],u>1){h=[];for(var g=0;g<u;g++)h.push([C(this.endian_mark+"l",this.tiftag.slice(c+g*8,c+4+g*8))[0],C(this.endian_mark+"l",this.tiftag.slice(c+4+g*8,c+8+g*8))[0]])}else h=[C(this.endian_mark+"l",this.tiftag.slice(c,c+4))[0],C(this.endian_mark+"l",this.tiftag.slice(c+4,c+8))[0]];else throw new Error("Exif might be wrong. Got incorrect value type to decode. type:"+f);return h instanceof Array&&h.length==1?h[0]:h}},typeof window<"u"&&typeof window.btoa=="function")var m=window.btoa;if(typeof m>"u")var m=function(h){for(var f="",u,d,c,g,v,I,x,L=0,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";L<h.length;)u=h.charCodeAt(L++),d=h.charCodeAt(L++),c=h.charCodeAt(L++),g=u>>2,v=(u&3)<<4|d>>4,I=(d&15)<<2|c>>6,x=c&63,isNaN(d)?I=x=64:isNaN(c)&&(x=64),f=f+k.charAt(g)+k.charAt(v)+k.charAt(I)+k.charAt(x);return f};if(typeof window<"u"&&typeof window.atob=="function")var T=window.atob;if(typeof T>"u")var T=function(h){var f="",u,d,c,g,v,I,x,L=0,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";for(h=h.replace(/[^A-Za-z0-9\+\/\=]/g,"");L<h.length;)g=k.indexOf(h.charAt(L++)),v=k.indexOf(h.charAt(L++)),I=k.indexOf(h.charAt(L++)),x=k.indexOf(h.charAt(L++)),u=g<<2|v>>4,d=(v&15)<<4|I>>2,c=(I&3)<<6|x,f=f+String.fromCharCode(u),I!=64&&(f=f+String.fromCharCode(d)),x!=64&&(f=f+String.fromCharCode(c));return f};function S(o,h){if(!(h instanceof Array))throw new Error("'pack' error. Got invalid type argument.");if(o.length-1!=h.length)throw new Error("'pack' error. "+(o.length-1)+" marks, "+h.length+" elements.");var f;if(o[0]=="<")f=!0;else if(o[0]==">")f=!1;else throw new Error("");for(var u="",d=1,c=null,g=null,v=null;g=o[d];){if(g.toLowerCase()=="b"){if(c=h[d-1],g=="b"&&c<0&&(c+=256),c>255||c<0)throw new Error("'pack' error.");v=String.fromCharCode(c)}else if(g=="H"){if(c=h[d-1],c>65535||c<0)throw new Error("'pack' error.");v=String.fromCharCode(Math.floor(c%65536/256))+String.fromCharCode(c%256),f&&(v=v.split("").reverse().join(""))}else if(g.toLowerCase()=="l"){if(c=h[d-1],g=="l"&&c<0&&(c+=4294967296),c>4294967295||c<0)throw new Error("'pack' error.");v=String.fromCharCode(Math.floor(c/16777216))+String.fromCharCode(Math.floor(c%16777216/65536))+String.fromCharCode(Math.floor(c%65536/256))+String.fromCharCode(c%256),f&&(v=v.split("").reverse().join(""))}else throw new Error("'pack' error.");u+=v,d+=1}return u}function C(o,h){if(typeof h!="string")throw new Error("'unpack' error. Got invalid type argument.");for(var f=0,u=1;u<o.length;u++)if(o[u].toLowerCase()=="b")f+=1;else if(o[u].toLowerCase()=="h")f+=2;else if(o[u].toLowerCase()=="l")f+=4;else throw new Error("'unpack' error. Got invalid mark.");if(f!=h.length)throw new Error("'unpack' error. Mismatch between symbol and string length. "+f+":"+h.length);var d;if(o[0]=="<")d=!0;else if(o[0]==">")d=!1;else throw new Error("'unpack' error.");for(var c=[],g=0,v=1,I=null,x=null,L=null,k="";x=o[v];){if(x.toLowerCase()=="b")L=1,k=h.slice(g,g+L),I=k.charCodeAt(0),x=="b"&&I>=128&&(I-=256);else if(x=="H")L=2,k=h.slice(g,g+L),d&&(k=k.split("").reverse().join("")),I=k.charCodeAt(0)*256+k.charCodeAt(1);else if(x.toLowerCase()=="l")L=4,k=h.slice(g,g+L),d&&(k=k.split("").reverse().join("")),I=k.charCodeAt(0)*16777216+k.charCodeAt(1)*65536+k.charCodeAt(2)*256+k.charCodeAt(3),x=="l"&&I>=2147483648&&(I-=4294967296);else throw new Error("'unpack' error. "+x);c.push(I),g+=L,v+=1}return c}function w(o,h){for(var f="",u=0;u<h;u++)f+=o;return f}function D(o){if(o.slice(0,2)!="ÿØ")throw new Error("Given data isn't JPEG.");for(var h=2,f=["ÿØ"];;){if(o.slice(h,h+2)=="ÿÚ"){f.push(o.slice(h));break}else{var u=C(">H",o.slice(h+2,h+4))[0],d=h+u+2;f.push(o.slice(h,d)),h=d}if(h>=o.length)throw new Error("Wrong JPEG data.")}return f}function q(o){for(var h,f=0;f<o.length;f++)if(h=o[f],h.slice(0,2)=="ÿá"&&h.slice(4,10)=="Exif\0\0")return h;return null}function Ae(o,h){var f=!1,u=[];return o.forEach(function(d,c){d.slice(0,2)=="ÿá"&&d.slice(4,10)=="Exif\0\0"&&(f?u.unshift(c):(o[c]=h,f=!0))}),u.forEach(function(d){o.splice(d,1)}),!f&&h&&(o=[o[0],h].concat(o.slice(1))),o.join("")}var j={Byte:1,Ascii:2,Short:3,Long:4,Rational:5,Undefined:7,SLong:9,SRational:10},B={Image:{11:{name:"ProcessingSoftware",type:"Ascii"},254:{name:"NewSubfileType",type:"Long"},255:{name:"SubfileType",type:"Short"},256:{name:"ImageWidth",type:"Long"},257:{name:"ImageLength",type:"Long"},258:{name:"BitsPerSample",type:"Short"},259:{name:"Compression",type:"Short"},262:{name:"PhotometricInterpretation",type:"Short"},263:{name:"Threshholding",type:"Short"},264:{name:"CellWidth",type:"Short"},265:{name:"CellLength",type:"Short"},266:{name:"FillOrder",type:"Short"},269:{name:"DocumentName",type:"Ascii"},270:{name:"ImageDescription",type:"Ascii"},271:{name:"Make",type:"Ascii"},272:{name:"Model",type:"Ascii"},273:{name:"StripOffsets",type:"Long"},274:{name:"Orientation",type:"Short"},277:{name:"SamplesPerPixel",type:"Short"},278:{name:"RowsPerStrip",type:"Long"},279:{name:"StripByteCounts",type:"Long"},282:{name:"XResolution",type:"Rational"},283:{name:"YResolution",type:"Rational"},284:{name:"PlanarConfiguration",type:"Short"},290:{name:"GrayResponseUnit",type:"Short"},291:{name:"GrayResponseCurve",type:"Short"},292:{name:"T4Options",type:"Long"},293:{name:"T6Options",type:"Long"},296:{name:"ResolutionUnit",type:"Short"},301:{name:"TransferFunction",type:"Short"},305:{name:"Software",type:"Ascii"},306:{name:"DateTime",type:"Ascii"},315:{name:"Artist",type:"Ascii"},316:{name:"HostComputer",type:"Ascii"},317:{name:"Predictor",type:"Short"},318:{name:"WhitePoint",type:"Rational"},319:{name:"PrimaryChromaticities",type:"Rational"},320:{name:"ColorMap",type:"Short"},321:{name:"HalftoneHints",type:"Short"},322:{name:"TileWidth",type:"Short"},323:{name:"TileLength",type:"Short"},324:{name:"TileOffsets",type:"Short"},325:{name:"TileByteCounts",type:"Short"},330:{name:"SubIFDs",type:"Long"},332:{name:"InkSet",type:"Short"},333:{name:"InkNames",type:"Ascii"},334:{name:"NumberOfInks",type:"Short"},336:{name:"DotRange",type:"Byte"},337:{name:"TargetPrinter",type:"Ascii"},338:{name:"ExtraSamples",type:"Short"},339:{name:"SampleFormat",type:"Short"},340:{name:"SMinSampleValue",type:"Short"},341:{name:"SMaxSampleValue",type:"Short"},342:{name:"TransferRange",type:"Short"},343:{name:"ClipPath",type:"Byte"},344:{name:"XClipPathUnits",type:"Long"},345:{name:"YClipPathUnits",type:"Long"},346:{name:"Indexed",type:"Short"},347:{name:"JPEGTables",type:"Undefined"},351:{name:"OPIProxy",type:"Short"},512:{name:"JPEGProc",type:"Long"},513:{name:"JPEGInterchangeFormat",type:"Long"},514:{name:"JPEGInterchangeFormatLength",type:"Long"},515:{name:"JPEGRestartInterval",type:"Short"},517:{name:"JPEGLosslessPredictors",type:"Short"},518:{name:"JPEGPointTransforms",type:"Short"},519:{name:"JPEGQTables",type:"Long"},520:{name:"JPEGDCTables",type:"Long"},521:{name:"JPEGACTables",type:"Long"},529:{name:"YCbCrCoefficients",type:"Rational"},530:{name:"YCbCrSubSampling",type:"Short"},531:{name:"YCbCrPositioning",type:"Short"},532:{name:"ReferenceBlackWhite",type:"Rational"},700:{name:"XMLPacket",type:"Byte"},18246:{name:"Rating",type:"Short"},18249:{name:"RatingPercent",type:"Short"},32781:{name:"ImageID",type:"Ascii"},33421:{name:"CFARepeatPatternDim",type:"Short"},33422:{name:"CFAPattern",type:"Byte"},33423:{name:"BatteryLevel",type:"Rational"},33432:{name:"Copyright",type:"Ascii"},33434:{name:"ExposureTime",type:"Rational"},34377:{name:"ImageResources",type:"Byte"},34665:{name:"ExifTag",type:"Long"},34675:{name:"InterColorProfile",type:"Undefined"},34853:{name:"GPSTag",type:"Long"},34857:{name:"Interlace",type:"Short"},34858:{name:"TimeZoneOffset",type:"Long"},34859:{name:"SelfTimerMode",type:"Short"},37387:{name:"FlashEnergy",type:"Rational"},37388:{name:"SpatialFrequencyResponse",type:"Undefined"},37389:{name:"Noise",type:"Undefined"},37390:{name:"FocalPlaneXResolution",type:"Rational"},37391:{name:"FocalPlaneYResolution",type:"Rational"},37392:{name:"FocalPlaneResolutionUnit",type:"Short"},37393:{name:"ImageNumber",type:"Long"},37394:{name:"SecurityClassification",type:"Ascii"},37395:{name:"ImageHistory",type:"Ascii"},37397:{name:"ExposureIndex",type:"Rational"},37398:{name:"TIFFEPStandardID",type:"Byte"},37399:{name:"SensingMethod",type:"Short"},40091:{name:"XPTitle",type:"Byte"},40092:{name:"XPComment",type:"Byte"},40093:{name:"XPAuthor",type:"Byte"},40094:{name:"XPKeywords",type:"Byte"},40095:{name:"XPSubject",type:"Byte"},50341:{name:"PrintImageMatching",type:"Undefined"},50706:{name:"DNGVersion",type:"Byte"},50707:{name:"DNGBackwardVersion",type:"Byte"},50708:{name:"UniqueCameraModel",type:"Ascii"},50709:{name:"LocalizedCameraModel",type:"Byte"},50710:{name:"CFAPlaneColor",type:"Byte"},50711:{name:"CFALayout",type:"Short"},50712:{name:"LinearizationTable",type:"Short"},50713:{name:"BlackLevelRepeatDim",type:"Short"},50714:{name:"BlackLevel",type:"Rational"},50715:{name:"BlackLevelDeltaH",type:"SRational"},50716:{name:"BlackLevelDeltaV",type:"SRational"},50717:{name:"WhiteLevel",type:"Short"},50718:{name:"DefaultScale",type:"Rational"},50719:{name:"DefaultCropOrigin",type:"Short"},50720:{name:"DefaultCropSize",type:"Short"},50721:{name:"ColorMatrix1",type:"SRational"},50722:{name:"ColorMatrix2",type:"SRational"},50723:{name:"CameraCalibration1",type:"SRational"},50724:{name:"CameraCalibration2",type:"SRational"},50725:{name:"ReductionMatrix1",type:"SRational"},50726:{name:"ReductionMatrix2",type:"SRational"},50727:{name:"AnalogBalance",type:"Rational"},50728:{name:"AsShotNeutral",type:"Short"},50729:{name:"AsShotWhiteXY",type:"Rational"},50730:{name:"BaselineExposure",type:"SRational"},50731:{name:"BaselineNoise",type:"Rational"},50732:{name:"BaselineSharpness",type:"Rational"},50733:{name:"BayerGreenSplit",type:"Long"},50734:{name:"LinearResponseLimit",type:"Rational"},50735:{name:"CameraSerialNumber",type:"Ascii"},50736:{name:"LensInfo",type:"Rational"},50737:{name:"ChromaBlurRadius",type:"Rational"},50738:{name:"AntiAliasStrength",type:"Rational"},50739:{name:"ShadowScale",type:"SRational"},50740:{name:"DNGPrivateData",type:"Byte"},50741:{name:"MakerNoteSafety",type:"Short"},50778:{name:"CalibrationIlluminant1",type:"Short"},50779:{name:"CalibrationIlluminant2",type:"Short"},50780:{name:"BestQualityScale",type:"Rational"},50781:{name:"RawDataUniqueID",type:"Byte"},50827:{name:"OriginalRawFileName",type:"Byte"},50828:{name:"OriginalRawFileData",type:"Undefined"},50829:{name:"ActiveArea",type:"Short"},50830:{name:"MaskedAreas",type:"Short"},50831:{name:"AsShotICCProfile",type:"Undefined"},50832:{name:"AsShotPreProfileMatrix",type:"SRational"},50833:{name:"CurrentICCProfile",type:"Undefined"},50834:{name:"CurrentPreProfileMatrix",type:"SRational"},50879:{name:"ColorimetricReference",type:"Short"},50931:{name:"CameraCalibrationSignature",type:"Byte"},50932:{name:"ProfileCalibrationSignature",type:"Byte"},50934:{name:"AsShotProfileName",type:"Byte"},50935:{name:"NoiseReductionApplied",type:"Rational"},50936:{name:"ProfileName",type:"Byte"},50937:{name:"ProfileHueSatMapDims",type:"Long"},50938:{name:"ProfileHueSatMapData1",type:"Float"},50939:{name:"ProfileHueSatMapData2",type:"Float"},50940:{name:"ProfileToneCurve",type:"Float"},50941:{name:"ProfileEmbedPolicy",type:"Long"},50942:{name:"ProfileCopyright",type:"Byte"},50964:{name:"ForwardMatrix1",type:"SRational"},50965:{name:"ForwardMatrix2",type:"SRational"},50966:{name:"PreviewApplicationName",type:"Byte"},50967:{name:"PreviewApplicationVersion",type:"Byte"},50968:{name:"PreviewSettingsName",type:"Byte"},50969:{name:"PreviewSettingsDigest",type:"Byte"},50970:{name:"PreviewColorSpace",type:"Long"},50971:{name:"PreviewDateTime",type:"Ascii"},50972:{name:"RawImageDigest",type:"Undefined"},50973:{name:"OriginalRawFileDigest",type:"Undefined"},50974:{name:"SubTileBlockSize",type:"Long"},50975:{name:"RowInterleaveFactor",type:"Long"},50981:{name:"ProfileLookTableDims",type:"Long"},50982:{name:"ProfileLookTableData",type:"Float"},51008:{name:"OpcodeList1",type:"Undefined"},51009:{name:"OpcodeList2",type:"Undefined"},51022:{name:"OpcodeList3",type:"Undefined"}},Exif:{33434:{name:"ExposureTime",type:"Rational"},33437:{name:"FNumber",type:"Rational"},34850:{name:"ExposureProgram",type:"Short"},34852:{name:"SpectralSensitivity",type:"Ascii"},34855:{name:"ISOSpeedRatings",type:"Short"},34856:{name:"OECF",type:"Undefined"},34864:{name:"SensitivityType",type:"Short"},34865:{name:"StandardOutputSensitivity",type:"Long"},34866:{name:"RecommendedExposureIndex",type:"Long"},34867:{name:"ISOSpeed",type:"Long"},34868:{name:"ISOSpeedLatitudeyyy",type:"Long"},34869:{name:"ISOSpeedLatitudezzz",type:"Long"},36864:{name:"ExifVersion",type:"Undefined"},36867:{name:"DateTimeOriginal",type:"Ascii"},36868:{name:"DateTimeDigitized",type:"Ascii"},37121:{name:"ComponentsConfiguration",type:"Undefined"},37122:{name:"CompressedBitsPerPixel",type:"Rational"},37377:{name:"ShutterSpeedValue",type:"SRational"},37378:{name:"ApertureValue",type:"Rational"},37379:{name:"BrightnessValue",type:"SRational"},37380:{name:"ExposureBiasValue",type:"SRational"},37381:{name:"MaxApertureValue",type:"Rational"},37382:{name:"SubjectDistance",type:"Rational"},37383:{name:"MeteringMode",type:"Short"},37384:{name:"LightSource",type:"Short"},37385:{name:"Flash",type:"Short"},37386:{name:"FocalLength",type:"Rational"},37396:{name:"SubjectArea",type:"Short"},37500:{name:"MakerNote",type:"Undefined"},37510:{name:"UserComment",type:"Ascii"},37520:{name:"SubSecTime",type:"Ascii"},37521:{name:"SubSecTimeOriginal",type:"Ascii"},37522:{name:"SubSecTimeDigitized",type:"Ascii"},40960:{name:"FlashpixVersion",type:"Undefined"},40961:{name:"ColorSpace",type:"Short"},40962:{name:"PixelXDimension",type:"Long"},40963:{name:"PixelYDimension",type:"Long"},40964:{name:"RelatedSoundFile",type:"Ascii"},40965:{name:"InteroperabilityTag",type:"Long"},41483:{name:"FlashEnergy",type:"Rational"},41484:{name:"SpatialFrequencyResponse",type:"Undefined"},41486:{name:"FocalPlaneXResolution",type:"Rational"},41487:{name:"FocalPlaneYResolution",type:"Rational"},41488:{name:"FocalPlaneResolutionUnit",type:"Short"},41492:{name:"SubjectLocation",type:"Short"},41493:{name:"ExposureIndex",type:"Rational"},41495:{name:"SensingMethod",type:"Short"},41728:{name:"FileSource",type:"Undefined"},41729:{name:"SceneType",type:"Undefined"},41730:{name:"CFAPattern",type:"Undefined"},41985:{name:"CustomRendered",type:"Short"},41986:{name:"ExposureMode",type:"Short"},41987:{name:"WhiteBalance",type:"Short"},41988:{name:"DigitalZoomRatio",type:"Rational"},41989:{name:"FocalLengthIn35mmFilm",type:"Short"},41990:{name:"SceneCaptureType",type:"Short"},41991:{name:"GainControl",type:"Short"},41992:{name:"Contrast",type:"Short"},41993:{name:"Saturation",type:"Short"},41994:{name:"Sharpness",type:"Short"},41995:{name:"DeviceSettingDescription",type:"Undefined"},41996:{name:"SubjectDistanceRange",type:"Short"},42016:{name:"ImageUniqueID",type:"Ascii"},42032:{name:"CameraOwnerName",type:"Ascii"},42033:{name:"BodySerialNumber",type:"Ascii"},42034:{name:"LensSpecification",type:"Rational"},42035:{name:"LensMake",type:"Ascii"},42036:{name:"LensModel",type:"Ascii"},42037:{name:"LensSerialNumber",type:"Ascii"},42240:{name:"Gamma",type:"Rational"}},GPS:{0:{name:"GPSVersionID",type:"Byte"},1:{name:"GPSLatitudeRef",type:"Ascii"},2:{name:"GPSLatitude",type:"Rational"},3:{name:"GPSLongitudeRef",type:"Ascii"},4:{name:"GPSLongitude",type:"Rational"},5:{name:"GPSAltitudeRef",type:"Byte"},6:{name:"GPSAltitude",type:"Rational"},7:{name:"GPSTimeStamp",type:"Rational"},8:{name:"GPSSatellites",type:"Ascii"},9:{name:"GPSStatus",type:"Ascii"},10:{name:"GPSMeasureMode",type:"Ascii"},11:{name:"GPSDOP",type:"Rational"},12:{name:"GPSSpeedRef",type:"Ascii"},13:{name:"GPSSpeed",type:"Rational"},14:{name:"GPSTrackRef",type:"Ascii"},15:{name:"GPSTrack",type:"Rational"},16:{name:"GPSImgDirectionRef",type:"Ascii"},17:{name:"GPSImgDirection",type:"Rational"},18:{name:"GPSMapDatum",type:"Ascii"},19:{name:"GPSDestLatitudeRef",type:"Ascii"},20:{name:"GPSDestLatitude",type:"Rational"},21:{name:"GPSDestLongitudeRef",type:"Ascii"},22:{name:"GPSDestLongitude",type:"Rational"},23:{name:"GPSDestBearingRef",type:"Ascii"},24:{name:"GPSDestBearing",type:"Rational"},25:{name:"GPSDestDistanceRef",type:"Ascii"},26:{name:"GPSDestDistance",type:"Rational"},27:{name:"GPSProcessingMethod",type:"Undefined"},28:{name:"GPSAreaInformation",type:"Undefined"},29:{name:"GPSDateStamp",type:"Ascii"},30:{name:"GPSDifferential",type:"Short"},31:{name:"GPSHPositioningError",type:"Rational"}},Interop:{1:{name:"InteroperabilityIndex",type:"Ascii"}}};B["0th"]=B.Image,B["1st"]=B.Image,t.TAGS=B,t.ImageIFD={ProcessingSoftware:11,NewSubfileType:254,SubfileType:255,ImageWidth:256,ImageLength:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Threshholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,XResolution:282,YResolution:283,PlanarConfiguration:284,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,TransferFunction:301,Software:305,DateTime:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,SubIFDs:330,InkSet:332,InkNames:333,NumberOfInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,JPEGProc:512,JPEGInterchangeFormat:513,JPEGInterchangeFormatLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,XMLPacket:700,Rating:18246,RatingPercent:18249,ImageID:32781,CFARepeatPatternDim:33421,CFAPattern:33422,BatteryLevel:33423,Copyright:33432,ExposureTime:33434,ImageResources:34377,ExifTag:34665,InterColorProfile:34675,GPSTag:34853,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,ExposureIndex:37397,TIFFEPStandardID:37398,SensingMethod:37399,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,PrintImageMatching:50341,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,LensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,CameraCalibrationSignature:50931,ProfileCalibrationSignature:50932,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041},t.ExifIFD={ExposureTime:33434,FNumber:33437,ExposureProgram:34850,SpectralSensitivity:34852,ISOSpeedRatings:34855,OECF:34856,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,ExifVersion:36864,DateTimeOriginal:36867,DateTimeDigitized:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureBiasValue:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,SubjectArea:37396,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,FlashpixVersion:40960,ColorSpace:40961,PixelXDimension:40962,PixelYDimension:40963,RelatedSoundFile:40964,InteroperabilityTag:40965,FlashEnergy:41483,SpatialFrequencyResponse:41484,FocalPlaneXResolution:41486,FocalPlaneYResolution:41487,FocalPlaneResolutionUnit:41488,SubjectLocation:41492,ExposureIndex:41493,SensingMethod:41495,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFilm:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,CameraOwnerName:42032,BodySerialNumber:42033,LensSpecification:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,Gamma:42240},t.GPSIFD={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},t.InteropIFD={InteroperabilityIndex:1},t.GPSHelper={degToDmsRational:function(o){var h=Math.abs(o),f=h%1*60,u=f%1*60,d=Math.floor(h),c=Math.floor(f),g=Math.round(u*100);return[[d,1],[c,1],[g,100]]},dmsRationalToDeg:function(o,h){var f=h==="S"||h==="W"?-1:1,u=o[0][0]/o[0][1]+o[1][0]/o[1][1]/60+o[2][0]/o[2][1]/3600;return u*f}},a.exports&&(e=a.exports=t),e.piexif=t})()})(ze,ze.exports);var se=ze.exports;const Xt="modulepreload",Kt=function(a,e){return new URL(a,e).href},ft={},$t=function(e,t,i){if(!t||t.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(r=>{if(r=Kt(r,i),r in ft)return;ft[r]=!0;const s=r.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(!!i)for(let P=n.length-1;P>=0;P--){const m=n[P];if(m.href===r&&(!s||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${l}`))return;const y=document.createElement("link");if(y.rel=s?"stylesheet":Xt,s||(y.as="script",y.crossOrigin=""),y.href=r,document.head.appendChild(y),s)return new Promise((P,m)=>{y.addEventListener("load",P),y.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};var Te=typeof self<"u"?self:global;const fe=typeof navigator<"u",Jt=fe&&typeof HTMLImageElement>"u",Ie=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Qe=Te.Buffer,pe=Te.BigInt,Ze=!!Qe,Yt=a=>a;function ve(a,e=Yt){if(Ie)try{return typeof require=="function"?Promise.resolve(e(require(a))):$t(()=>import(a),[],import.meta.url).then(e)}catch(t){console.warn(`Couldn't load ${a}`)}}let et=Te.fetch;const qt=a=>et=a;if(!Te.fetch){const a=ve("http",i=>i),e=ve("https",i=>i),t=(i,{headers:n}={})=>new Promise(async(r,s)=>{let{port:l,hostname:p,pathname:y,protocol:P,search:m}=new URL(i);const T={method:"GET",hostname:p,path:encodeURI(y)+m,headers:n};l!==""&&(T.port=Number(l));const S=(P==="https:"?await e:await a).request(T,C=>{if(C.statusCode===301||C.statusCode===302){let w=new URL(C.headers.location,i).toString();return t(w,{headers:n}).then(r).catch(s)}r({status:C.statusCode,arrayBuffer:()=>new Promise(w=>{let D=[];C.on("data",q=>D.push(q)),C.on("end",()=>w(Buffer.concat(D)))})})});S.on("error",s),S.end()});qt(t)}function b(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}const we=a=>At(a)?void 0:a,Qt=a=>a!==void 0;function At(a){return a===void 0||(a instanceof Map?a.size===0:Object.values(a).filter(Qt).length===0)}function R(a){let e=new Error(a);throw delete e.stack,e}function W(a){return(a=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(a).trim())===""?void 0:a}function _e(a){let e=function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048}(a);return a.jfif.enabled&&(e+=50),a.xmp.enabled&&(e+=2e4),a.iptc.enabled&&(e+=14e3),a.icc.enabled&&(e+=6e3),e}const je=a=>String.fromCharCode.apply(null,a),ct=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;function Ot(a){return ct?ct.decode(a):Ze?Buffer.from(a).toString("utf8"):decodeURIComponent(escape(je(a)))}class E{static from(e,t){return e instanceof this&&e.le===t?e:new E(e,void 0,void 0,t)}constructor(e,t=0,i,n){if(typeof n=="boolean"&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let r=new DataView(e,t,i);this._swapDataView(r)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof E){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&R("Creating view outside of available memory in ArrayBuffer");let r=new DataView(e.buffer,t,i);this._swapDataView(r)}else if(typeof e=="number"){let r=new DataView(new ArrayBuffer(e));this._swapDataView(r)}else R("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=E){return e instanceof DataView||e instanceof E?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||R("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new E(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return Ot(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return je(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return je(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function We(a,e){R(`${a} '${e}' was not loaded, try using full build of exifr.`)}class tt extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||We(this.kind,e),t&&(e in t||function(i,n){R(`Unknown ${i} '${n}'.`)}(this.kind,e),t[e].enabled||We(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var J=new tt("file parser"),M=new tt("segment parser"),Y=new tt("file reader");function Zt(a,e){return typeof a=="string"?ut(a,e):fe&&!Jt&&a instanceof HTMLImageElement?ut(a.src,e):a instanceof Uint8Array||a instanceof ArrayBuffer||a instanceof DataView?new E(a):fe&&a instanceof Blob?Xe(a,e,"blob",Je):void R("Invalid input argument")}function ut(a,e){return(t=a).startsWith("data:")||t.length>1e4?Ke(a,e,"base64"):Ie&&a.includes("://")?Xe(a,e,"url",$e):Ie?Ke(a,e,"fs"):fe?Xe(a,e,"url",$e):void R("Invalid input argument");var t}async function Xe(a,e,t,i){return Y.has(t)?Ke(a,e,t):i?async function(n,r){let s=await r(n);return new E(s)}(a,i):void R(`Parser ${t} is not loaded`)}async function Ke(a,e,t){let i=new(Y.get(t))(a,e);return await i.read(),i}const $e=a=>et(a).then(e=>e.arrayBuffer()),Je=a=>new Promise((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(a)});class ei extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function O(a,e,t){let i=new ei;for(let[n,r]of t)i.set(n,r);if(Array.isArray(e))for(let n of e)a.set(n,i);else a.set(e,i);return i}function Ye(a,e,t){let i,n=a.get(e);for(i of t)n.set(i[0],i[1])}const G=new Map,X=new Map,be=new Map,ge=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Mt=["jfif","xmp","icc","iptc","ihdr"],qe=["tiff",...Mt],A=["ifd0","ifd1","exif","gps","interop"],me=[...qe,...A],Se=["makerNote","userComment"],Ft=["translateKeys","translateValues","reviveValues","multiSegment"],ye=[...Ft,"sanitize","mergeOutput","silentErrors"];class Et{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class oe extends Et{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),b(this,"enabled",!1),b(this,"skip",new Set),b(this,"pick",new Set),b(this,"deps",new Set),b(this,"translateKeys",!1),b(this,"translateValues",!1),b(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=A.includes(e),this.canBeFiltered&&(this.dict=G.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:r,skip:s}=i;r&&r.length>0&&this.translateTagSet(r,this.pick),s&&s.length>0&&this.translateTagSet(s,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:R(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of Ft)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:r,tagValues:s}=this.dict;for(i of e)typeof i=="string"?(n=s.indexOf(i),n===-1&&(n=r.indexOf(Number(i))),n!==-1&&t.add(Number(r[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ke(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ke(this.pick,this.deps)}}var F={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},dt=new Map;class it extends Et{static useCached(e){let t=dt.get(e);return t!==void 0||(t=new this(e),dt.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):R(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=fe?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of ge)this[e]=F[e];for(e of ye)this[e]=F[e];for(e of Se)this[e]=F[e];for(e of me)this[e]=new oe(e,F[e],void 0,this)}setupFromTrue(){let e;for(e of ge)this[e]=F[e];for(e of ye)this[e]=F[e];for(e of Se)this[e]=!0;for(e of me)this[e]=new oe(e,!0,void 0,this)}setupFromArray(e){let t;for(t of ge)this[t]=F[t];for(t of ye)this[t]=F[t];for(t of Se)this[t]=F[t];for(t of me)this[t]=new oe(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,A)}setupFromObject(e){let t;for(t of(A.ifd0=A.ifd0||A.image,A.ifd1=A.ifd1||A.thumbnail,Object.assign(this,e),ge))this[t]=Ge(e[t],F[t]);for(t of ye)this[t]=Ge(e[t],F[t]);for(t of Se)this[t]=Ge(e[t],F[t]);for(t of qe)this[t]=new oe(t,F[t],e[t],this);for(t of A)this[t]=new oe(t,F[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,A,me),e.tiff===!0?this.batchEnableWithBool(A,!0):e.tiff===!1?this.batchEnableWithUserValue(A,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,A):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,A)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let n=t[i];this[i].enabled=n!==!1&&n!==void 0}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let s of n)this[s].enabled=!1;let r=pt(e,i);for(let[s,l]of r)ke(this[s].pick,l),this[s].enabled=!0}else if(t&&t.length){let r=pt(t,i);for(let[s,l]of r)ke(this[s].skip,l)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:r}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),r.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=A.some(r=>this[r].enabled===!0)||this.makerNote||this.userComment;for(let r of A)this[r].finalizeFilters()}get onlyTiff(){return!Mt.map(e=>this[e].enabled).some(e=>e===!0)&&this.tiff.enabled}checkLoadedPlugins(){for(let e of qe)this[e].enabled&&!M.has(e)&&We("segment parser",e)}}function pt(a,e){let t,i,n,r,s=[];for(n of e){for(r of(t=G.get(n),i=[],t))(a.includes(r[0])||a.includes(r[1]))&&i.push(r[0]);i.length&&s.push([n,i])}return s}function Ge(a,e){return a!==void 0?a:e!==void 0?e:void 0}function ke(a,e){for(let t of e)a.add(t)}b(it,"default",F);class ti{constructor(e){b(this,"parsers",{}),b(this,"output",{}),b(this,"errors",[]),b(this,"pushToErrors",t=>this.errors.push(t)),this.options=it.useCached(e)}async read(e){this.file=await Zt(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of J)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),R("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),we(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map(async i=>{let n=await i.parse();i.assignToOutput(e,n)});this.options.silentErrors&&(t=t.map(i=>i.catch(this.pushToErrors))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=M.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),n===void 0)return;let r=await this.fileParser.ensureSegmentChunk(n),s=this.parsers.tiff=new i(r,e,t),l=await s.extractThumbnail();return t.close&&t.close(),l}}async function ii(a,e){let t=new ti(e);return await t.read(a),t.parse()}class De{constructor(e,t,i){b(this,"errors",[]),b(this,"ensureSegmentChunk",async n=>{let r=n.start,s=n.size||65536;if(this.file.chunked)if(this.file.available(r,s))n.chunk=this.file.subarray(r,s);else try{n.chunk=await this.file.readChunk(r,s)}catch(l){R(`Couldn't read segment: ${JSON.stringify(n)}. ${l.message}`)}else this.file.byteLength>r+s?n.chunk=this.file.subarray(r,s):n.size===void 0?n.chunk=this.file.subarray(r):R("Segment unreachable: "+JSON.stringify(n));return n.chunk}),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(M.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:n}=t,r=this.options[i];if(r&&r.enabled){let s=this.parsers[i];s&&s.append||s||this.createParser(i,n)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class U{static findPosition(e,t){let i=e.getUint16(t+2)+2,n=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,r=t+n,s=i-n;return{offset:t,length:i,headerLength:n,start:r,size:s,end:r+s}}static parse(e,t={}){return new this(e,new it({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof E?e:new E(e)}constructor(e,t={},i){b(this,"errors",[]),b(this,"raw",new Map),b(this,"handleError",n=>{if(!this.options.silentErrors)throw n;this.errors.push(n.message)}),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=be.get(t),n=X.get(t),r=G.get(t),s=this.options[t],l=s.reviveValues&&!!i,p=s.translateValues&&!!n,y=s.translateKeys&&!!r,P={};for(let[m,T]of e)l&&i.has(m)?T=i.get(m)(T):p&&n.has(m)&&(T=this.translateValue(T,n.get(m))),y&&r.has(m)&&(m=r.get(m)||m),P[m]=T;return P}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}b(U,"headerLength",4),b(U,"type",void 0),b(U,"multiSegment",!1),b(U,"canHandle",()=>!1);function ni(a){return a===192||a===194||a===196||a===219||a===221||a===218||a===254}function ai(a){return a>=224&&a<=239}function ri(a,e,t){for(let[i,n]of M)if(n.canHandle(a,e,t))return i}class gt extends De{constructor(...e){super(...e),b(this,"appSegments",[]),b(this,"jpegSegments",[]),b(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(M.keyList())):(e=e===void 0?M.keyList().filter(t=>this.options[t].enabled):e.filter(t=>this.options[t].enabled&&M.has(t)),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:r,remaining:s}=this;if(!n&&this.file.chunked&&(n=Array.from(r).some(l=>{let p=M.get(l),y=this.options[l];return p.multiSegment&&y.multiSegment}),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let l=!1;for(;s.size>0&&!l&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:p}=i,y=this.appSegments.some(P=>!this.file.available(P.offset||P.start,P.length||P.size));if(l=e>p&&!y?!await i.readNextChunk(e):!await i.readNextChunk(p),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,r,s,l,p,{file:y,findAll:P,wanted:m,remaining:T,options:S}=this;for(;e<t;e++)if(y.getUint8(e)===255){if(i=y.getUint8(e+1),ai(i)){if(n=y.getUint16(e+2),r=ri(y,e,n),r&&m.has(r)&&(s=M.get(r),l=s.findPosition(y,e),p=S[r],l.type=r,this.appSegments.push(l),!P&&(s.multiSegment&&p.multiSegment?(this.unfinishedMultiSegment=l.chunkNumber<l.chunkCount,this.unfinishedMultiSegment||T.delete(r)):T.delete(r),T.size===0)))break;S.recordUnknownSegments&&(l=U.findPosition(y,e),l.marker=i,this.unknownSegments.push(l)),e+=n+1}else if(ni(i)){if(n=y.getUint16(e+2),i===218&&S.stopAfterSos!==!1)return;S.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}}return e}mergeMultiSegments(){if(!this.appSegments.some(t=>t.multiSegment))return;let e=function(t,i){let n,r,s,l=new Map;for(let p=0;p<t.length;p++)n=t[p],r=n[i],l.has(r)?s=l.get(r):l.set(r,s=[]),s.push(n);return Array.from(l)}(this.appSegments,"type");this.mergedAppSegments=e.map(([t,i])=>{let n=M.get(t,this.options);return n.handleMultiSegments?{type:t,chunk:n.handleMultiSegments(i)}:i[0]})}getSegment(e){return this.appSegments.find(t=>t.type===e)}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}b(gt,"type","jpeg"),J.set("jpeg",gt);const si=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class oi extends U{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:r}=this.options[t];n=new Set(n);let s=n.size>0,l=r.size===0,p=this.chunk.getUint16(e);e+=2;for(let y=0;y<p;y++){let P=this.chunk.getUint16(e);if(s){if(n.has(P)&&(i.set(P,this.parseTag(e,P,t)),n.delete(P),n.size===0))break}else!l&&r.has(P)||i.set(P,this.parseTag(e,P,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,r=n.getUint16(e+2),s=n.getUint32(e+4),l=si[r];if(l*s<=4?e+=8:e=n.getUint32(e+8),(r<1||r>13)&&R(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e}`),e>n.byteLength&&R(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${n.byteLength}`),r===1)return n.getUint8Array(e,s);if(r===2)return W(n.getString(e,s));if(r===7)return n.getUint8Array(e,s);if(s===1)return this.parseTagValue(r,e);{let p=new(function(P){switch(P){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(r))(s),y=l;for(let P=0;P<s;P++)p[P]=this.parseTagValue(r,e),e+=y;return p}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:R(`Invalid tiff type ${e}`)}}}class Ue extends oi{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&R("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&R(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,_e(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,_e(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",mt(...e.get(2),e.get(1))),e.set("longitude",mt(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of A)if(e=this[t],!At(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}}function mt(a,e,t,i){var n=a+e/60+t/3600;return i!=="S"&&i!=="W"||(n*=-1),n}b(Ue,"type","tiff"),b(Ue,"headerLength",10),M.set("tiff",Ue);const nt={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},nt,{firstChunkSize:4e4,gps:[1,2,3,4]});Object.assign({},nt,{tiff:!1,ifd1:!0,mergeOutput:!1});async function li(a){let e=await this.thumbnail(a);if(e!==void 0){let t=new Blob([e]);return URL.createObjectURL(t)}}Object.assign({},nt,{firstChunkSize:4e4,ifd0:[274]});if(typeof navigator=="object"){let a=navigator.userAgent;a.includes("iPad")||a.includes("iPhone")?a.match(/OS (\d+)_(\d+)/):a.includes("OS X 10")&&a.match(/OS X 10[_.](\d+)/),a.includes("Chrome/")?a.match(/Chrome\/(\d+)/):a.includes("Firefox/")&&a.match(/Firefox\/(\d+)/)}class hi extends E{constructor(...e){super(...e),b(this,"ranges",new fi),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let n=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(n)}else{let n=e+t;if(n>this.byteLength){let{dataView:r}=this._extend(n);this._swapDataView(r)}}}_extend(e){let t;t=Ze?Qe.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class fi{constructor(){b(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,r=this.list.filter(s=>St(e,s.offset,n)||St(e,s.end,n));if(r.length>0){e=Math.min(e,...r.map(l=>l.offset)),n=Math.max(n,...r.map(l=>l.end)),t=n-e;let s=r.shift();s.offset=e,s.length=t,s.end=n,this.list=this.list.filter(l=>!r.includes(l))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some(n=>n.offset<=e&&i<=n.end)}}function St(a,e,t){return a<=e&&e<=t}class Re extends hi{constructor(e,t){super(0),b(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}Y.set("blob",class extends Re{async readWhole(){this.chunked=!1;let a=await Je(this.input);this._swapArrayBuffer(a)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(a,e){let t=e?a+e:void 0,i=this.input.slice(a,t),n=await Je(i);return this.set(n,a,!0)}});Y.set("url",class extends Re{async readWhole(){this.chunked=!1;let a=await $e(this.input);a instanceof ArrayBuffer?this._swapArrayBuffer(a):a instanceof Uint8Array&&this._swapBuffer(a)}async _readChunk(a,e){let t=e?a+e-1:void 0,i=this.options.httpHeaders||{};(a||t)&&(i.range=`bytes=${[a,t].join("-")}`);let n=await et(this.input,{headers:i}),r=await n.arrayBuffer(),s=r.byteLength;if(n.status!==416)return s!==e&&(this.size=a+s),this.set(r,a,!0)}});E.prototype.getUint64=function(a){let e=this.getUint32(a),t=this.getUint32(a+4);return e<1048575?e<<32|t:typeof pe!==void 0?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),pe(e)<<pe(32)|pe(t)):void R("Trying to read 64b value but JS can only handle 53b numbers.")};class ci extends De{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),i.length===0)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return e.boxes===void 0&&this.parseSubBoxes(e),e.boxes.find(i=>i.kind===t)}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return t===1&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(e.version!==void 0)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Gt extends ci{static canHandle(e,t){if(t!==0)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,r=[];for(;n<i;)r.push(e.getString(n,4)),n+=4;return r.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;t.kind!=="meta";)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(t===void 0)return;let i=this.findBox(t,"ipco");if(i===void 0)return;let n=this.findBox(i,"colr");n!==void 0&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(t===void 0)return;let i=this.findBox(e,"iloc");if(i===void 0)return;let n=this.findExifLocIdInIinf(t),r=this.findExtentInIloc(i,n);if(r===void 0)return;let[s,l]=r;await this.file.ensureChunk(s,l);let p=4+this.file.getUint32(s);s+=p,l-=p,await this.registerSegment("tiff",s,l)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,r,s=e.start,l=this.file.getUint16(s);for(s+=2;l--;){if(t=this.parseBoxHead(s),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=t.version===3?4:2,r=this.file.getString(i+n+2,4),r==="Exif"))return this.file.getUintBytes(i,n);s+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,r]=this.get8bits(i++),[s,l]=this.get8bits(i++),p=e.version===2?4:2,y=e.version===1||e.version===2?2:0,P=l+n+r,m=e.version===2?4:2,T=this.file.getUintBytes(i,m);for(i+=m;T--;){let S=this.file.getUintBytes(i,p);i+=p+y+2+s;let C=this.file.getUint16(i);if(i+=2,S===t)return C>1&&console.warn(`ILOC box has more than one extent but we're only processing one
Please create an issue at https://github.com/MikeKovarik/exifr with this file`),[this.file.getUintBytes(i+l,n),this.file.getUintBytes(i+l+n,r)];i+=C*P}}}class Ut extends Gt{}b(Ut,"type","heic");class yt extends Gt{}b(yt,"type","avif"),J.set("heic",Ut),J.set("avif",yt),O(G,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),O(G,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),O(G,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),O(X,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let he=O(X,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Ct={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};he.set(37392,Ct),he.set(41488,Ct);const Be={0:"Normal",1:"Low",2:"High"};function Pt(a){return typeof a=="object"&&a.length!==void 0?a[0]:a}function bt(a){let e=Array.from(a).slice(1);return e[1]>15&&(e=e.map(t=>String.fromCharCode(t))),e[2]!=="0"&&e[2]!==0||e.pop(),e.join(".")}function Ne(a){if(typeof a=="string"){var[e,t,i,n,r,s]=a.trim().split(/[-: ]/g).map(Number),l=new Date(e,t-1,i);return Number.isNaN(n)||Number.isNaN(r)||Number.isNaN(s)||(l.setHours(n),l.setMinutes(r),l.setSeconds(s)),Number.isNaN(+l)?a:l}}function le(a){if(typeof a=="string")return a;let e=[];if(a[1]===0&&a[a.length-1]===0)for(let t=0;t<a.length;t+=2)e.push(xt(a[t+1],a[t]));else for(let t=0;t<a.length;t+=2)e.push(xt(a[t],a[t+1]));return W(String.fromCodePoint(...e))}function xt(a,e){return a<<8|e}he.set(41992,Be),he.set(41993,Be),he.set(41994,Be),O(be,["ifd0","ifd1"],[[50827,function(a){return typeof a!="string"?Ot(a):a}],[306,Ne],[40091,le],[40092,le],[40093,le],[40094,le],[40095,le]]),O(be,"exif",[[40960,bt],[36864,bt],[36867,Ne],[36868,Ne],[40962,Pt],[40963,Pt]]),O(be,"gps",[[0,a=>Array.from(a).join(".")],[7,a=>Array.from(a).join(":")]]);class Ve extends U{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1752462448&&e.getString(t+4,20)==="http://ns.adobe.com/"}static headerLength(e,t){return e.getString(t+4,34)==="http://ns.adobe.com/xmp/extension/"?79:4+28+1}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=i.headerLength===79,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),e.getUint8(t+77)!==0&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map(t=>t.chunk.getString()).join("")}normalizeInput(e){return typeof e=="string"?e:E.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(r){let s={},l={};for(let p of Ht)s[p]=[],l[p]=0;return r.replace(gi,(p,y,P)=>{if(y==="<"){let m=++l[P];return s[P].push(m),`${p}#${m}`}return`${p}#${s[P].pop()}`})}(e);let t=$.findAll(e,"rdf","Description");t.length===0&&t.push(new $("rdf","Description",void 0,e));let i,n={};for(let r of t)for(let s of r.properties)i=pi(s.ns,n),Bt(s,i);return function(r){let s;for(let l in r)s=r[l]=we(r[l]),s===void 0&&delete r[l];return we(r)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}}b(Ve,"type","xmp"),b(Ve,"multiSegment",!0),M.set("xmp",Ve);class Le{static findAll(e){return Nt(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Le.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=Vt(n),new Le(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class ${static findAll(e,t,i){if(t!==void 0||i!==void 0){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return Nt(e,n).map($.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],r=e[8];return new $(t,i,n,r)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=Le.findAll(i),this.children=$.findAll(n),this.value=this.children.length===0?Vt(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return this.value!==void 0&&this.attrs.length===0&&this.children.length===0}get isListContainer(){return this.children.length===1&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return e==="rdf"&&(t==="Seq"||t==="Bag"||t==="Alt")}get isListItem(){return this.ns==="rdf"&&this.name==="li"}serialize(){if(this.properties.length===0&&this.value===void 0)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return di(this.children.map(ui));if(this.isListItem&&this.children.length===1&&this.attrs.length===0)return this.children[0].serialize();let e={};for(let t of this.properties)Bt(t,e);return this.value!==void 0&&(e.value=this.value),we(e)}}function Bt(a,e){let t=a.serialize();t!==void 0&&(e[a.name]=t)}var ui=a=>a.serialize(),di=a=>a.length===1?a[0]:a,pi=(a,e)=>e[a]?e[a]:e[a]={};function Nt(a,e){let t,i=[];if(!a)return i;for(;(t=e.exec(a))!==null;)i.push(t);return i}function Vt(a){if(function(i){return i==null||i==="null"||i==="undefined"||i===""||i.trim()===""}(a))return;let e=Number(a);if(!Number.isNaN(e))return e;let t=a.toLowerCase();return t==="true"||t!=="false"&&a.trim()}const Ht=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],gi=new RegExp(`(<|\\/)(${Ht.join("|")})`,"g");let It=ve("fs",a=>a.promises);Y.set("fs",class extends Re{async readWhole(){this.chunked=!1,this.fs=await It;let a=await this.fs.readFile(this.input);this._swapBuffer(a)}async readChunked(){this.chunked=!0,this.fs=await It,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){this.fh===void 0&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(a,e){this.fh===void 0&&await this.open(),a+e>this.size&&(e=this.size-a);var t=this.subarray(a,e,!0);return await this.fh.read(t.dataView,0,e,a),t}async close(){if(this.fh){let a=this.fh;this.fh=void 0,await a.close()}}});Y.set("base64",class extends Re{constructor(...a){super(...a),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(a,e){let t,i,n=this.input;a===void 0?(a=0,t=0,i=0):(t=4*Math.floor(a/3),i=a-t/4*3),e===void 0&&(e=this.size);let r=a+e,s=t+4*Math.ceil(r/3);n=n.slice(t,s);let l=Math.min(e,this.size-a);if(Ze){let p=Qe.from(n,"base64").slice(i,i+l);return this.set(p,a,!0)}{let p=this.subarray(a,l,!0),y=atob(n),P=p.toUint8();for(let m=0;m<l;m++)P[m]=y.charCodeAt(i+m);return p}}});class vt extends De{static canHandle(e,t){return t===18761||t===19789}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:r}=e;i.enabled&&t.deps.add(700),n.enabled&&t.deps.add(33723),r.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let r=Math.max(_e(this.options),this.options.chunkSize);await this.file.ensureChunk(0,r),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}b(vt,"type","tiff"),J.set("tiff",vt);let mi=ve("zlib");const Si=["ihdr","iccp","text","itxt","exif"];class wt extends De{constructor(...e){super(...e),b(this,"catchError",t=>this.errors.push(t)),b(this,"metaChunks",[]),b(this,"unknownChunks",[])}static canHandle(e,t){return t===35152&&e.getUint32(0)===2303741511&&e.getUint32(4)===218765834}async parse(){let{file:e}=this;await this.findPngChunksInRange(8,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let n=i.getUint32(e),r=i.getUint32(e+4),s=i.getString(e+4,4).toLowerCase(),l=n+4+4+4,p={type:s,offset:e,length:l,start:e+4+4,size:n,marker:r};Si.includes(s)?this.metaChunks.push(p):this.unknownChunks.push(p),e+=l}}parseTextChunks(){let e=this.metaChunks.filter(t=>t.type==="text");for(let t of e){let[i,n]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(i,n)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find(t=>t.type==="ihdr");e&&this.options.ihdr.enabled!==!1&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find(t=>t.type==="exif");e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter(t=>t.type==="itxt");for(let t of e)t.chunk.getString(0,17)==="XML:com.adobe.xmp"&&this.injectSegment("xmp",t.chunk)}async findIcc(){let e=this.metaChunks.find(l=>l.type==="iccp");if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),n=0;for(;n<80&&i[n]!==0;)n++;let r=n+2,s=t.getString(0,n);if(this.injectKeyValToIhdr("ProfileName",s),Ie){let l=await mi,p=t.getUint8Array(r);p=l.inflateSync(p),this.injectSegment("icc",p)}}}b(wt,"type","png"),J.set("png",wt),O(G,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),Ye(G,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let kt=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];Ye(G,"ifd0",kt),Ye(G,"exif",kt),O(X,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class He extends U{static canHandle(e,t){return e.getUint8(t+1)===224&&e.getUint32(t+4)===1246120262&&e.getUint8(t+8)===0}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}b(He,"type","jfif"),b(He,"headerLength",9),M.set("jfif",He),O(G,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class Lt extends U{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}b(Lt,"type","ihdr"),M.set("ihdr",Lt),O(G,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),O(X,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class xe extends U{static canHandle(e,t){return e.getUint8(t+1)===226&&e.getUint32(t+4)===1229144927}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(t){let i=function(n){let r=n[0].constructor,s=0;for(let y of n)s+=y.length;let l=new r(s),p=0;for(let y of n)l.set(y,p),p+=y.length;return l}(t.map(n=>n.chunk.toUint8()));return new E(i)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&R("ICC header is too short");for(let[t,i]of Object.entries(yi)){t=parseInt(t,10);let n=i(this.chunk,t);n!=="\0\0\0\0"&&e.set(t,n)}}parseTags(){let e,t,i,n,r,{raw:s}=this,l=this.chunk.getUint32(128),p=132,y=this.chunk.byteLength;for(;l--;){if(e=this.chunk.getString(p,4),t=this.chunk.getUint32(p+4),i=this.chunk.getUint32(p+8),n=this.chunk.getString(t,4),t+i>y)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");r=this.parseTag(n,t,i),r!==void 0&&r!=="\0\0\0\0"&&s.set(e,r),p+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return W(this.chunk.getString(e+12,t))}parseText(e,t){return W(this.chunk.getString(e+8,t-8))}parseSig(e){return W(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),r=e+16,s=[];for(let l=0;l<i;l++){let p=t.getString(r+0,2),y=t.getString(r+2,2),P=t.getUint32(r+4),m=t.getUint32(r+8)+e,T=W(t.getUnicodeString(m,P));s.push({lang:p,country:y,text:T}),r+=n}return i===1?s[0].text:s}translateValue(e,t){return typeof e=="string"?t[e]||t[e.toLowerCase()]||e:t[e]||e}}b(xe,"type","icc"),b(xe,"multiSegment",!0),b(xe,"headerLength",18);const yi={4:z,8:function(a,e){return[a.getUint8(e),a.getUint8(e+1)>>4,a.getUint8(e+1)%16].map(t=>t.toString(10)).join(".")},12:z,16:z,20:z,24:function(a,e){const t=a.getUint16(e),i=a.getUint16(e+2)-1,n=a.getUint16(e+4),r=a.getUint16(e+6),s=a.getUint16(e+8),l=a.getUint16(e+10);return new Date(Date.UTC(t,i,n,r,s,l))},36:z,40:z,48:z,52:z,64:(a,e)=>a.getUint32(e),80:z};function z(a,e){return W(a.getString(e,4))}M.set("icc",xe),O(G,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const Ce={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Tt={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};O(X,"icc",[[4,Ce],[12,Tt],[40,Object.assign({},Ce,Tt)],[48,Ce],[80,Ce],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class Pe extends U{static canHandle(e,t,i){return e.getUint8(t+1)===237&&e.getString(t+4,9)==="Photoshop"&&this.containsIptc8bim(e,t,i)!==void 0}static headerLength(e,t,i){let n,r=this.containsIptc8bim(e,t,i);if(r!==void 0)return n=e.getUint8(t+r+7),n%2!=0&&(n+=1),n===0&&(n=4),r+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return e.getUint8(t)===56&&e.getUint32(t)===943868237&&e.getUint16(t+4)===1028}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(this.chunk.getUint8(n)===28&&this.chunk.getUint8(n+1)===2){i=!0;let r=this.chunk.getUint16(n+3),s=this.chunk.getUint8(n+2),l=this.chunk.getLatin1String(n+5,r);e.set(s,this.pluralizeValue(e.get(s),l)),n+=4+r}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return e!==void 0?e instanceof Array?(e.push(t),e):[e,t]:t}}b(Pe,"type","iptc"),b(Pe,"translateValues",!1),b(Pe,"reviveValues",!1),M.set("iptc",Pe),O(G,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),O(X,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);const Ci=""+new URL("Canon-9b6acea0.svg",import.meta.url).href,Pi=""+new URL("Fujifilm_2006-b864405e.svg",import.meta.url).href,Dt=""+new URL("leica-887c663a.svg",import.meta.url).href,bi=""+new URL("Nikon_2003-f5731c81.svg",import.meta.url).href,xi=""+new URL("Olympus_Corporation_logo-73482387.svg",import.meta.url).href,Ii=""+new URL("Panasonic-37428438.svg",import.meta.url).href,vi=""+new URL("Sony-c5ac1b64.svg",import.meta.url).href;let Rt;window.addEventListener("DOMContentLoaded",()=>{document.querySelector("#fileInput").addEventListener("change",async a=>{const e=new FileReader,t=a.target.files[0];if(!a.target||!a.target.files.length||!a.target.files[0])return;const i=await ii(t,!0);console.log(i),e.addEventListener("loadend",async n=>{const r=new Image;Rt=n.target.result,r.src=(/jpg|jpeg|gif|png|tif|tiff|heic/i.test(t.name.split(".")[t.name.split(".").length-1])?n.target.result.toString():await li(t))||"undefined",r.src=="undefined"&&alert("不受支持的图片格式!"),r.addEventListener("load",()=>{const s=document.querySelector("canvas#canvas"),l=s.getContext("2d"),p=r.height*.15;s.height=r.height+p,s.width=r.width,l.fillStyle="#FFF",l.fillRect(0,0,s.width,s.height),l.drawImage(r,0,0);const y=`${i.Make} ${i.Model}`,P=`f/${i.FNumber} ${i.ExposureTime>1?Math.round(i.ExposureTime/1)*10/10:`1/${Math.round(1/i.ExposureTime)}`} ISO${i.ISO}`,m=i.DateTimeOriginal||i.CreateDate||i.ModifyDate,T=`${m==null?void 0:m.getFullYear()}.${m==null?void 0:m.getMonth()}.${m==null?void 0:m.getDate()} ${m==null?void 0:m.getHours()}:${m==null?void 0:m.getMinutes()}:${m==null?void 0:m.getSeconds()}`;let S;i.GPSLatitude&&i.GPSLongitude&&(S=`${i.GPSLatitude[0]}°${i.GPSLatitude[1]}′${Math.round(i.GPSLatitude[2])}″${i.GPSLatitudeRef||""}  ${i.GPSLongitude[0]}°${i.GPSLongitude[1]}′${Math.round(i.GPSLongitude[2])}″${i.GPSLongitudeRef||""}`),function(w){l.fillStyle="#000",l.font=`bold ${p*.2}px 'MiSans'`,l.textBaseline="top",l.textAlign="left",l.fillText(w,p*.3,r.height+p*.3)}(y),function(w){l.fillStyle="#000",l.font=`bold ${p*.2}px 'MiSans'`,l.textBaseline="top",l.textAlign="right",l.fillText(w,r.width-p*.3,r.height+p*.3)}(P),function(w,D){l.fillStyle="#737373",l.font=`${p*.17}px 'MiSans'`,l.textBaseline="top",l.textAlign="right",D!==void 0?(l.fillText(D,r.width-p*.3,r.height+p*.55),l.textAlign="left",l.fillText(w,p*.3,r.height+p*.55)):l.fillText(w,r.width-p*.3,r.height+p*.55)}(T,S),function(){l.fillStyle="#d3d3d3",l.textBaseline="top",l.textAlign="left",l.font=`bold ${p*.2}px 'MiSans'`;const w=l.measureText(P).width;l.font=`bold ${p*.17}px 'MiSans'`;const D=l.measureText(S||T).width;l.fillRect(r.width-Math.max(w,D)-p*.3-r.width*.01,r.height+p*.28,r.width*-.0025,p*.425)}(),function(){const w=new Image;let D=Dt;switch(i.Make){case"SONY":{D=vi;break}case"Canon":{D=Ci;break}case"NIKON CORPORATION":{D=bi;break}case"FUJIFILM":{D=Pi;break}case"Panasonic":{D=Ii;break}case"OM Digital Solutions":{D=xi;break}default:{D=Dt;break}}w.src=D,w.addEventListener("load",()=>{l.font=`bold ${p*.2}px 'MiSans'`;const q=l.measureText(P).width;l.font=`bold ${p*.17}px 'MiSans'`;const Ae=l.measureText(S||T).width,j=p*.425,B=j*(w.width/w.height);l.drawImage(w,r.width-Math.max(q,Ae)-p*.3-r.width*.02-B,r.height+p*.28,B,j)})}(),document.querySelector("#saveImageBtn").addEventListener("click",()=>{const C=se.load(Rt);C["0th"][se.ImageIFD.ProcessingSoftware]="Leica Generator by Yuameshi",C["0th"][se.ImageIFD.Software]="Leica Generator by Yuameshi";let w=se.dump(C);const D=document.createElement("a");D.href=se.insert(w,s.toDataURL("image/jpeg",1)),D.download=`${t.name}-Leica.jpg`,D.click()})})}),e.readAsDataURL(t)})});export{wi as __vite_legacy_guard};
